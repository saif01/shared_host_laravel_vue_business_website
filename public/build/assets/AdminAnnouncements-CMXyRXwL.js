import{a as H}from"./adminPaginationMixin-DN7Wb3ng.js";import{R as J}from"./RichTextEditor-CyfRClUH.js";import{_ as L,c as x,w as l,b as n,r as a,f as u,t as c,a as o,d as h,e as B,F as O,m as Q,o as m,n as z,h as _}from"./app-Dh6wD5JW.js";import{r as R,n as X}from"./uploads-CnEkgyD_.js";const Z={name:"DateTimePicker",props:{modelValue:{type:String,default:null},label:{type:String,default:"Date & Time"},hint:{type:String,default:""},persistentHint:{type:Boolean,default:!1},variant:{type:String,default:"outlined"},prependIcon:{type:String,default:"mdi-calendar-clock"},title:{type:String,default:null},titleIcon:{type:String,default:"mdi-calendar-clock"},clearable:{type:Boolean,default:!0},readonly:{type:Boolean,default:!0},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},errorMessages:{type:[String,Array],default:null},minDate:{type:String,default:null},maxDate:{type:String,default:null},cardWidth:{type:[String,Number],default:280}},emits:["update:modelValue"],data(){return{menuOpen:!1,datePicker:null,timePicker:null,currentDate:new Date}},computed:{displayValue(){if(!this.modelValue)return"";const i=new Date(this.modelValue);return isNaN(i.getTime())?"":i.toLocaleString()},weekDays(){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},currentMonthYear(){return this.currentDate.toLocaleDateString("en-US",{month:"long",year:"numeric"})},calendarDays(){const i=this.currentDate.getFullYear(),e=this.currentDate.getMonth(),r=new Date(i,e,1),t=new Date(i,e+1,0).getDate(),s=r.getDay(),A=new Date(i,e,0).getDate(),I=[];let k=[];for(let w=s-1;w>=0;w--){const f=A-w,v=new Date(i,e-1,f);k.push(this.createDayObject(v,!1))}for(let w=1;w<=t;w++){const f=new Date(i,e,w);k.push(this.createDayObject(f,!0)),k.length===7&&(I.push([...k]),k=[])}let T=1;for(;k.length<7;){const w=new Date(i,e+1,T);k.push(this.createDayObject(w,!1)),T++}return k.length>0&&I.push(k),I}},watch:{modelValue:{immediate:!0,handler(i){if(i){const e=new Date(i);if(isNaN(e.getTime()))this.datePicker=null,this.timePicker=null;else{const r=e.toISOString().split("T")[0];this.datePicker=r,this.currentDate=new Date(e),this.timePicker=String(e.getHours()).padStart(2,"0")+":"+String(e.getMinutes()).padStart(2,"0")}}else this.datePicker=null,this.timePicker=null}}},methods:{createDayObject(i,e){const r=i.toISOString().split("T")[0],t=new Date().toISOString().split("T")[0];let s=!1;return this.minDate&&r<this.minDate&&(s=!0),this.maxDate&&r>this.maxDate&&(s=!0),{day:i.getDate(),date:r,currentMonth:e,selected:this.datePicker===r,isToday:r===t,disabled:s}},selectDate(i){i&&(this.datePicker=i,this.updateDateTime())},previousMonth(){const i=new Date(this.currentDate);i.setMonth(i.getMonth()-1),this.currentDate=i},nextMonth(){const i=new Date(this.currentDate);i.setMonth(i.getMonth()+1),this.currentDate=i},updateDateTime(){if(this.datePicker){const i=this.timePicker||"00:00",[e,r]=i.split(":"),p=new Date(this.datePicker);p.setHours(parseInt(e)||0),p.setMinutes(parseInt(r)||0),p.setSeconds(0),p.setMilliseconds(0),this.$emit("update:modelValue",p.toISOString())}else this.$emit("update:modelValue",null)},clearValue(){this.datePicker=null,this.timePicker=null,this.$emit("update:modelValue",null),this.menuOpen=!1}}},$={class:"calendar-container mb-1"},ee={class:"d-flex justify-space-between align-center mb-1 calendar-header"},te={class:"text-caption font-weight-medium"},ne={class:"calendar-weekdays d-flex"},ie={class:"calendar-days"},le=["disabled","onClick"];function oe(i,e,r,p,t,s){const y=a("v-text-field"),A=a("v-icon"),I=a("v-card-title"),k=a("v-btn"),T=a("v-divider"),w=a("v-card-text"),f=a("v-spacer"),v=a("v-card-actions"),V=a("v-card"),D=a("v-menu");return m(),x(D,{modelValue:t.menuOpen,"onUpdate:modelValue":e[2]||(e[2]=b=>t.menuOpen=b),"close-on-content-click":!1,location:"bottom start"},{activator:l(({props:b})=>[n(y,Q({"model-value":s.displayValue,label:r.label,variant:r.variant,"prepend-inner-icon":r.prependIcon,hint:r.hint,"persistent-hint":r.persistentHint,readonly:r.readonly,clearable:r.clearable,required:r.required,disabled:r.disabled,error:r.error,"error-messages":r.errorMessages},b,{"onClick:clear":s.clearValue}),null,16,["model-value","label","variant","prepend-inner-icon","hint","persistent-hint","readonly","clearable","required","disabled","error","error-messages","onClick:clear"])]),default:l(()=>[n(V,{"min-width":r.cardWidth,class:"pa-1"},{default:l(()=>[n(I,{class:"text-caption mb-0 pa-1"},{default:l(()=>[n(A,{icon:r.titleIcon,class:"mr-1",size:"small"},null,8,["icon"]),u(" "+c(r.title||`Select ${r.label}`),1)]),_:1}),n(w,{class:"pa-1"},{default:l(()=>[o("div",$,[o("div",ee,[n(k,{icon:"mdi-chevron-left",variant:"text",size:"x-small",density:"compact",onClick:s.previousMonth},null,8,["onClick"]),o("div",te,c(s.currentMonthYear),1),n(k,{icon:"mdi-chevron-right",variant:"text",size:"x-small",density:"compact",onClick:s.nextMonth},null,8,["onClick"])]),o("div",ne,[(m(!0),h(O,null,B(s.weekDays,b=>(m(),h("div",{class:"calendar-weekday",key:b},c(b),1))),128))]),o("div",ie,[(m(!0),h(O,null,B(s.calendarDays,(b,F)=>(m(),h("div",{key:F,class:"calendar-week d-flex"},[(m(!0),h(O,null,B(b,(P,C)=>(m(),h("button",{key:C,class:z(["calendar-day",{"calendar-day-other-month":!P.currentMonth,"calendar-day-selected":P.selected,"calendar-day-today":P.isToday,"calendar-day-disabled":P.disabled}]),disabled:P.disabled,onClick:U=>s.selectDate(P.date)},c(P.day),11,le))),128))]))),128))])]),n(T,{class:"my-1"}),n(y,{modelValue:t.timePicker,"onUpdate:modelValue":[e[0]||(e[0]=b=>t.timePicker=b),s.updateDateTime],label:"Time",type:"time",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-clock-outline",class:"mt-1 time-field","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),n(v,{class:"pa-1"},{default:l(()=>[n(f),n(k,{variant:"text",size:"small",density:"compact",onClick:s.clearValue},{default:l(()=>e[3]||(e[3]=[u("Clear")])),_:1,__:[3]},8,["onClick"]),n(k,{color:"primary",variant:"text",size:"small",density:"compact",onClick:e[1]||(e[1]=b=>t.menuOpen=!1)},{default:l(()=>e[4]||(e[4]=[u("OK")])),_:1,__:[4]})]),_:1})]),_:1},8,["min-width"])]),_:1},8,["modelValue"])}const se=L(Z,[["render",oe],["__scopeId","data-v-9f6c3a41"]]),ae={name:"AnnouncementFormDialog",components:{RichTextEditor:J,DateTimePicker:se},mixins:[H],props:{modelValue:{type:Boolean,default:!1},editingAnnouncement:{type:Object,default:null}},emits:["update:modelValue","saved"],data(){return{activeTab:"basic",loading:!1,saving:!1,imageFile:null,imagePreview:null,uploadingImage:!1,imageError:null,ogImageFile:null,ogImagePreview:null,uploadingOgImage:!1,ogImageError:null,typeOptions:[{title:"Company News",value:"company_news"},{title:"Offers / Promotions",value:"offers_promotions"},{title:"Events",value:"events"},{title:"Holidays",value:"holidays"},{title:"Urgent Alerts",value:"urgent_alerts"}],displayTypeOptions:[{title:"Slider Banner",value:"slider_banner"},{title:"Popup",value:"popup"},{title:"Sidebar Ticker",value:"sidebar_ticker"},{title:"Page Section",value:"page_section"}],form:{title:"",slug:"",content:"",short_description:"",type:"company_news",display_type:"slider_banner",image:"",video:"",external_link:"",open_in_new_tab:!1,start_date:"",end_date:"",is_active:!0,priority:0,language:"",meta_title:"",meta_description:"",meta_keywords:"",og_image:""}}},computed:{dialog:{get(){return this.modelValue},set(i){this.$emit("update:modelValue",i)}},suggestedMetaTitle(){return this.form.meta_title||!this.form.title?null:this.form.title.length>60?this.form.title.substring(0,57)+"...":this.form.title},suggestedMetaDescription(){if(this.form.meta_description||!this.form.short_description)return null;let i=this.form.short_description;if(i.length>160){i=i.substring(0,157);const e=i.lastIndexOf(" ");e>120?i=i.substring(0,e)+"...":i+="..."}return i},suggestedMetaKeywords(){return this.form.meta_keywords?null:this.generateSuggestedKeywords()}},watch:{modelValue(i){i&&(this.editingAnnouncement?this.loadAnnouncementData():this.resetForm())}},methods:{normalizeImageInput(i){return X(i)},resolveImageUrl(i){return R(i)},resetForm(){this.form={title:"",slug:"",content:"",short_description:"",type:"company_news",display_type:"slider_banner",image:"",video:"",external_link:"",open_in_new_tab:!1,start_date:"",end_date:"",is_active:!0,priority:0,language:"",meta_title:"",meta_description:"",meta_keywords:"",og_image:""},this.imageFile=null,this.imagePreview=null,this.ogImageFile=null,this.ogImagePreview=null,this.activeTab="basic"},async loadAnnouncementData(){if(this.editingAnnouncement)try{this.loading=!0;const e=(await this.$axios.get(`/api/v1/announcements/${this.editingAnnouncement.id}`,{headers:this.getAuthHeaders()})).data,r=this.normalizeImageInput(e.image||""),p=this.normalizeImageInput(e.og_image||"");this.form={title:e.title||"",slug:e.slug||"",content:e.content||"",short_description:e.short_description||"",type:e.type||"company_news",display_type:e.display_type||"slider_banner",image:r,video:e.video||"",external_link:e.external_link||"",open_in_new_tab:e.open_in_new_tab||!1,start_date:e.start_date||"",end_date:e.end_date||"",is_active:e.is_active!==void 0?e.is_active:!0,priority:e.priority||0,language:e.language||"",meta_title:e.meta_title||"",meta_description:e.meta_description||"",meta_keywords:e.meta_keywords||"",og_image:p},this.imagePreview=e.image?this.resolveImageUrl(e.image||r):null,this.ogImagePreview=e.og_image?this.resolveImageUrl(e.og_image||p):null}catch(i){this.handleApiError(i,"Failed to load announcement data"),this.closeDialog()}finally{this.loading=!1}},formatDateTimeForInput(i){if(!i)return"";const e=new Date(i);return isNaN(e.getTime())?"":e.toISOString()},getStartDateForMin(){if(this.form.start_date){const i=new Date(this.form.start_date);if(!isNaN(i.getTime()))return i.toISOString().split("T")[0]}return null},generateSlug(){this.form.title&&!this.editingAnnouncement&&(this.form.slug=this.form.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},handleImageSelect(i){if(this.imageError=null,i){const e=Array.isArray(i)?i[0]:i;if(e&&e.size>5242880){this.imageError="Image file size must be less than 5MB",this.imageFile=null;return}if(e&&!e.type.startsWith("image/")){this.imageError="Please select a valid image file (jpeg, jpg, png, gif, webp)",this.imageFile=null;return}if(this.imageFile=e,e){const r=new FileReader;r.onload=p=>{this.imagePreview=p.target.result},r.onerror=()=>{this.showError("Failed to read image file"),this.imageFile=null,this.imagePreview=null},r.readAsDataURL(e)}else this.imagePreview=null}else this.imageFile=null,this.form.image?this.imagePreview=this.resolveImageUrl(this.form.image):this.imagePreview=null},async uploadImage(){var e,r;if(!this.imageFile)return null;const i=Array.isArray(this.imageFile)?this.imageFile[0]:this.imageFile;if(!i)return null;this.uploadingImage=!0;try{const p=new FormData;p.append("image",i),p.append("folder","announcements"),this.form.title&&p.append("prefix",this.form.title);const t=await this.$axios.post("/api/v1/upload/image",p,{headers:{...this.getAuthHeaders(),"Content-Type":"multipart/form-data"}});if(t.data.success){const s=this.normalizeImageInput(t.data.path||t.data.url);return this.form.image=s,this.imagePreview=this.resolveImageUrl(t.data.url||s),this.imageFile=null,this.imageError=null,s}else throw new Error(t.data.message||"Failed to upload image")}catch(p){let t="Failed to upload image";throw(r=(e=p.response)==null?void 0:e.data)!=null&&r.message&&(t=p.response.data.message),this.imageError=t,new Error(t)}finally{this.uploadingImage=!1}},removeImage(){confirm("Are you sure you want to remove this image?")&&(this.imagePreview=null,this.imageFile=null,this.form.image="",this.imageError=null)},handleOgImageSelect(i){if(this.ogImageError=null,i){const e=Array.isArray(i)?i[0]:i;if(e&&e.size>5242880){this.ogImageError="OG image file size must be less than 5MB",this.ogImageFile=null;return}if(e&&!e.type.startsWith("image/")){this.ogImageError="Please select a valid image file (jpeg, jpg, png, gif, webp)",this.ogImageFile=null;return}if(this.ogImageFile=e,e){const r=new FileReader;r.onload=p=>{this.ogImagePreview=p.target.result},r.onerror=()=>{this.showError("Failed to read image file"),this.ogImageFile=null,this.ogImagePreview=null},r.readAsDataURL(e)}else this.ogImagePreview=null}else this.ogImageFile=null,this.form.og_image?this.ogImagePreview=this.resolveImageUrl(this.form.og_image):this.ogImagePreview=null},async uploadOgImage(){var e,r;if(!this.ogImageFile)return null;const i=Array.isArray(this.ogImageFile)?this.ogImageFile[0]:this.ogImageFile;if(!i)return null;this.uploadingOgImage=!0;try{const p=new FormData;p.append("image",i),p.append("folder","announcements"),this.form.title&&p.append("prefix",this.form.title);const t=await this.$axios.post("/api/v1/upload/image",p,{headers:{...this.getAuthHeaders(),"Content-Type":"multipart/form-data"}});if(t.data.success){const s=this.normalizeImageInput(t.data.path||t.data.url);return this.form.og_image=s,this.ogImagePreview=this.resolveImageUrl(t.data.url||s),this.ogImageFile=null,this.ogImageError=null,s}else throw new Error(t.data.message||"Failed to upload OG image")}catch(p){let t="Failed to upload OG image";throw(r=(e=p.response)==null?void 0:e.data)!=null&&r.message&&(t=p.response.data.message),this.ogImageError=t,new Error(t)}finally{this.uploadingOgImage=!1}},removeOgImage(){confirm("Are you sure you want to remove the Open Graph image?")&&(this.ogImagePreview=null,this.ogImageFile=null,this.form.og_image="",this.ogImageError=null)},async saveAnnouncement(){const{valid:i}=await this.$refs.formRef.validate();if(!i){this.showError("Please fill in all required fields");return}this.saving=!0;try{if(this.imageFile)try{await this.uploadImage()}catch(p){this.showError(p.message||"Failed to upload image"),this.saving=!1;return}if(this.ogImageFile)try{await this.uploadOgImage()}catch(p){this.showError(p.message||"Failed to upload OG image"),this.saving=!1;return}const e={...this.form};e.image&&(e.image=this.normalizeImageInput(e.image)),e.og_image&&(e.og_image=this.normalizeImageInput(e.og_image)),e.start_date&&(e.start_date=new Date(e.start_date).toISOString()),e.end_date&&(e.end_date=new Date(e.end_date).toISOString());let r;this.editingAnnouncement?r=await this.$axios.put(`/api/v1/announcements/${this.editingAnnouncement.id}`,e,{headers:this.getAuthHeaders()}):r=await this.$axios.post("/api/v1/announcements",e,{headers:this.getAuthHeaders()}),this.showSuccess(this.editingAnnouncement?"Announcement updated successfully":"Announcement created successfully"),this.$emit("saved",r.data),this.closeDialog()}catch(e){this.handleApiError(e,this.editingAnnouncement?"Failed to update announcement":"Failed to create announcement")}finally{this.saving=!1}},closeDialog(){!this.saving&&!this.loading&&(this.resetForm(),this.dialog=!1)},generateMetaTitle(){this.form.title&&(this.form.meta_title=this.form.title.length>60?this.form.title.substring(0,57)+"...":this.form.title)},generateMetaDescription(){if(this.form.short_description){let i=this.form.short_description;if(i.length>160){i=i.substring(0,157);const e=i.lastIndexOf(" ");e>120?i=i.substring(0,e)+"...":i+="..."}this.form.meta_description=i}},generateMetaKeywords(){const i=this.generateSuggestedKeywords();i&&(this.form.meta_keywords=i)},generateSuggestedKeywords(){const i=[];if(this.form.title){const p=this.form.title.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(t=>t.length>3).slice(0,5);i.push(...p)}if(this.form.short_description){const p=this.form.short_description.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(t=>t.length>4).slice(0,5);i.push(...p)}if(this.form.type){const t={company_news:"company news",offers_promotions:"offers promotions",events:"events",holidays:"holidays",urgent_alerts:"urgent alerts"}[this.form.type]||this.form.type;i.push(t)}const e=["the","and","for","with","from","this","that","your","our","announcement","announcements","about","when","where"],r=[...new Set(i)].filter(p=>!e.includes(p)).slice(0,10);return r.length>0?r.join(", "):null},applySuggestedMetaTitle(){this.suggestedMetaTitle&&(this.form.meta_title=this.suggestedMetaTitle)},applySuggestedMetaDescription(){this.suggestedMetaDescription&&(this.form.meta_description=this.suggestedMetaDescription)},applySuggestedMetaKeywords(){this.suggestedMetaKeywords&&(this.form.meta_keywords=this.suggestedMetaKeywords)},getMetaTitleColor(){const i=this.form.meta_title?this.form.meta_title.length:0;return i===0?"primary":i<50?"warning":i>60?"error":"success"},getMetaDescriptionColor(){const i=this.form.meta_description?this.form.meta_description.length:0;return i===0?"primary":i<120?"warning":i>160?"error":"success"},getPreviewTitle(){return this.form.meta_title||this.form.title||"Announcement Title"},getPreviewDescription(){return this.form.meta_description||this.form.short_description||"Announcement description will appear here in search results..."},getPreviewUrl(){const i=window.location.origin||"https://example.com",e=this.form.slug||"announcement-slug";return`${i}/announcements/${e}`}}},re={class:"text-h5 font-weight-bold"},de={key:0,class:"d-flex align-center justify-center pa-12"},me={class:"text-center"},ue={class:"pa-6"},ce={class:"pa-6"},ge={key:0,class:"mb-4"},pe={class:"text-body-2"},fe={class:"pa-6"},_e={class:"pa-6"},he={class:"d-flex align-center justify-space-between"},ve={class:"text-body-2"},ye={key:0,class:"ml-2"},be={key:1,class:"ml-2"},we={key:2,class:"ml-2 text-success"},xe={class:"d-flex align-center justify-space-between flex-wrap"},ke={class:"text-body-2 mb-2"},De={key:0,class:"ml-2"},Ie={key:1,class:"ml-2"},Ve={key:2,class:"ml-2 text-success"},Se={class:"d-flex align-center justify-space-between flex-wrap"},Ae={class:"text-body-2 mb-2"},Te={class:"text-caption text-medium-emphasis"},Pe={class:"d-flex flex-column flex-md-row align-start"},Ce={key:0,class:"mr-md-4 mb-4 mb-md-0"},Fe={class:"mt-2"},Me={class:"flex-grow-1"},Ue={class:"text-body-2"},Ee={key:2,class:"text-caption text-medium-emphasis mt-2"},Oe={class:"search-preview"},ze={class:"search-url mb-1 text-caption",style:{color:"#006621"}};function Be(i,e,r,p,t,s){const y=a("v-btn"),A=a("v-card-title"),I=a("v-progress-circular"),k=a("v-tab"),T=a("v-tabs"),w=a("v-text-field"),f=a("v-col"),v=a("v-select"),V=a("v-textarea"),D=a("v-row"),b=a("v-window-item"),F=a("v-label"),P=a("RichTextEditor"),C=a("v-divider"),U=a("v-img"),g=a("v-file-input"),S=a("v-alert"),E=a("v-card"),M=a("v-switch"),N=a("DateTimePicker"),j=a("v-window"),K=a("v-form"),W=a("v-card-text"),G=a("v-spacer"),q=a("v-card-actions"),Y=a("v-dialog");return m(),x(Y,{modelValue:s.dialog,"onUpdate:modelValue":e[23]||(e[23]=d=>s.dialog=d),"max-width":"1200",scrollable:"",persistent:""},{default:l(()=>[n(E,null,{default:l(()=>[n(A,{class:"d-flex align-center justify-space-between bg-primary text-white pa-4"},{default:l(()=>[o("span",re,c(r.editingAnnouncement?"Edit Announcement":"Create New Announcement"),1),n(y,{icon:"mdi-close",variant:"text",color:"white",onClick:s.closeDialog,disabled:t.saving||t.loading},null,8,["onClick","disabled"])]),_:1}),n(W,{class:"pa-0"},{default:l(()=>[t.loading?(m(),h("div",de,[o("div",me,[n(I,{indeterminate:"",color:"primary",size:"64"}),e[24]||(e[24]=o("p",{class:"text-body-1 text-medium-emphasis mt-4"},"Loading announcement data...",-1))])])):(m(),x(K,{key:1,ref:"formRef"},{default:l(()=>[n(T,{modelValue:t.activeTab,"onUpdate:modelValue":e[0]||(e[0]=d=>t.activeTab=d),"bg-color":"grey-lighten-4"},{default:l(()=>[n(k,{value:"basic"},{default:l(()=>e[25]||(e[25]=[u("Basic Information")])),_:1,__:[25]}),n(k,{value:"content"},{default:l(()=>e[26]||(e[26]=[u("Content")])),_:1,__:[26]}),n(k,{value:"settings"},{default:l(()=>e[27]||(e[27]=[u("Settings & Schedule")])),_:1,__:[27]}),n(k,{value:"seo"},{default:l(()=>e[28]||(e[28]=[u("SEO & Meta")])),_:1,__:[28]})]),_:1},8,["modelValue"]),n(j,{modelValue:t.activeTab,"onUpdate:modelValue":e[22]||(e[22]=d=>t.activeTab=d)},{default:l(()=>[n(b,{value:"basic"},{default:l(()=>[o("div",ue,[n(D,null,{default:l(()=>[n(f,{cols:"12"},{default:l(()=>[n(w,{modelValue:t.form.title,"onUpdate:modelValue":e[1]||(e[1]=d=>t.form.title=d),label:"Announcement Title *",variant:"outlined",rules:[d=>!!d||"Title is required"],hint:"Enter the announcement title",onBlur:s.generateSlug,"persistent-hint":""},null,8,["modelValue","rules","onBlur"])]),_:1}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(w,{modelValue:t.form.slug,"onUpdate:modelValue":e[2]||(e[2]=d=>t.form.slug=d),label:"Slug *",variant:"outlined",rules:[d=>!!d||"Slug is required",d=>!d||/^[a-z0-9-]+$/.test(d)||"Slug can only contain lowercase letters, numbers, and hyphens"],hint:"URL-friendly version (auto-generated from title)","persistent-hint":""},{append:l(()=>[n(y,{icon:"mdi-refresh",size:"small",variant:"text",onClick:s.generateSlug,disabled:!t.form.title},null,8,["onClick","disabled"])]),_:1},8,["modelValue","rules"])]),_:1}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(v,{modelValue:t.form.type,"onUpdate:modelValue":e[3]||(e[3]=d=>t.form.type=d),items:t.typeOptions,label:"Type *",variant:"outlined",rules:[d=>!!d||"Type is required"],hint:"Announcement category","persistent-hint":""},null,8,["modelValue","items","rules"])]),_:1}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(v,{modelValue:t.form.display_type,"onUpdate:modelValue":e[4]||(e[4]=d=>t.form.display_type=d),items:t.displayTypeOptions,label:"Display Type *",variant:"outlined",rules:[d=>!!d||"Display type is required"],hint:"How the announcement will be displayed","persistent-hint":""},null,8,["modelValue","items","rules"])]),_:1}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(w,{modelValue:t.form.priority,"onUpdate:modelValue":e[5]||(e[5]=d=>t.form.priority=d),label:"Priority",type:"number",variant:"outlined",hint:"Higher priority shows first (0-999)","persistent-hint":"",min:"0",max:"999"},null,8,["modelValue"])]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(V,{modelValue:t.form.short_description,"onUpdate:modelValue":e[6]||(e[6]=d=>t.form.short_description=d),label:"Short Description",variant:"outlined",rows:"3",hint:"Brief description shown in listings","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),n(b,{value:"content"},{default:l(()=>[o("div",ce,[n(D,null,{default:l(()=>[n(f,{cols:"12"},{default:l(()=>[n(F,{class:"mb-2"},{default:l(()=>e[29]||(e[29]=[u("Full Content")])),_:1,__:[29]}),n(P,{modelValue:t.form.content,"onUpdate:modelValue":e[7]||(e[7]=d=>t.form.content=d),active:t.activeTab==="content",placeholder:"Enter detailed announcement content..."},null,8,["modelValue","active"])]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(C,{class:"my-4"}),e[30]||(e[30]=o("h3",{class:"text-h6 font-weight-bold mb-4"},"Media",-1))]),_:1,__:[30]}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(F,{class:"mb-2"},{default:l(()=>e[31]||(e[31]=[u("Image")])),_:1,__:[31]}),n(E,{variant:"outlined",class:"pa-4"},{default:l(()=>[t.imagePreview||t.form.image?(m(),h("div",ge,[n(U,{src:t.imagePreview||s.resolveImageUrl(t.form.image),"max-width":"300","max-height":"300",class:"rounded elevation-2",cover:""},null,8,["src"]),n(y,{color:"error",size:"small",variant:"text",class:"mt-2",onClick:s.removeImage,"prepend-icon":"mdi-delete"},{default:l(()=>e[32]||(e[32]=[u(" Remove Image ")])),_:1,__:[32]},8,["onClick"])])):_("",!0),n(g,{modelValue:t.imageFile,"onUpdate:modelValue":[e[8]||(e[8]=d=>t.imageFile=d),s.handleImageSelect],accept:"image/*",label:"Select Image",variant:"outlined","prepend-inner-icon":"mdi-image","show-size":"",clearable:""},{append:l(()=>[t.uploadingImage?(m(),x(I,{key:0,indeterminate:"",color:"primary",size:"24"})):_("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"]),t.imageFile&&t.imageFile.size>5242880?(m(),x(S,{key:1,type:"warning",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>e[33]||(e[33]=[u(" File size is larger than 5MB. Please choose a smaller image. ")])),_:1,__:[33]})):_("",!0),t.imageError?(m(),x(S,{key:2,type:"error",variant:"tonal",density:"compact",class:"mt-2",closable:"","onClick:close":e[9]||(e[9]=d=>t.imageError=null)},{default:l(()=>[o("div",pe,[e[34]||(e[34]=o("strong",null,"Upload Error:",-1)),u(" "+c(t.imageError),1)])]),_:1})):_("",!0)]),_:1})]),_:1}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(F,{class:"mb-2"},{default:l(()=>e[35]||(e[35]=[u("Video (URL or file path)")])),_:1,__:[35]}),n(w,{modelValue:t.form.video,"onUpdate:modelValue":e[10]||(e[10]=d=>t.form.video=d),label:"Video URL or Path",variant:"outlined",hint:"Enter video URL, YouTube link (youtube.com or youtu.be), or upload file path","persistent-hint":"",placeholder:"https://youtu.be/VIDEO_ID or https://www.youtube.com/watch?v=VIDEO_ID"},null,8,["modelValue"])]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(C,{class:"my-4"}),e[36]||(e[36]=o("h3",{class:"text-h6 font-weight-bold mb-4"},"External Link",-1))]),_:1,__:[36]}),n(f,{cols:"12",md:"10"},{default:l(()=>[n(w,{modelValue:t.form.external_link,"onUpdate:modelValue":e[11]||(e[11]=d=>t.form.external_link=d),label:"External Link URL",variant:"outlined",hint:"Optional link to external page","persistent-hint":"",type:"url"},null,8,["modelValue"])]),_:1}),n(f,{cols:"12",md:"2"},{default:l(()=>[n(M,{modelValue:t.form.open_in_new_tab,"onUpdate:modelValue":e[12]||(e[12]=d=>t.form.open_in_new_tab=d),label:"Open in new tab",color:"primary",hint:"Open link in new browser tab","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),n(b,{value:"settings"},{default:l(()=>[o("div",fe,[n(D,null,{default:l(()=>[n(f,{cols:"12"},{default:l(()=>e[37]||(e[37]=[o("h3",{class:"text-h6 font-weight-bold mb-4"},"Schedule",-1)])),_:1,__:[37]}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(N,{modelValue:t.form.start_date,"onUpdate:modelValue":e[13]||(e[13]=d=>t.form.start_date=d),label:"Start Date & Time",hint:"When announcement becomes active","persistent-hint":!0,title:"Select Start Date & Time"},null,8,["modelValue"])]),_:1}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(N,{modelValue:t.form.end_date,"onUpdate:modelValue":e[14]||(e[14]=d=>t.form.end_date=d),label:"End Date & Time",hint:"When announcement expires","persistent-hint":!0,"min-date":s.getStartDateForMin(),title:"Select End Date & Time"},null,8,["modelValue","min-date"])]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(C,{class:"my-4"}),e[38]||(e[38]=o("h3",{class:"text-h6 font-weight-bold mb-4"},"Status & Settings",-1))]),_:1,__:[38]}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(M,{modelValue:t.form.is_active,"onUpdate:modelValue":e[15]||(e[15]=d=>t.form.is_active=d),label:"Active",color:"success",hint:"Make this announcement active","persistent-hint":""},null,8,["modelValue"])]),_:1}),n(f,{cols:"12",md:"6"},{default:l(()=>[n(w,{modelValue:t.form.language,"onUpdate:modelValue":e[16]||(e[16]=d=>t.form.language=d),label:"Language",variant:"outlined",hint:"Language code (e.g., en, ar) - optional for multi-language","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1}),n(b,{value:"seo"},{default:l(()=>[o("div",_e,[n(S,{type:"info",variant:"tonal",class:"mb-6",density:"compact"},{default:l(()=>e[39]||(e[39]=[o("div",{class:"text-body-2"},[o("strong",null,"SEO Best Practices:"),u(" Fill in these fields to improve your announcement visibility in search engines and social media. If left empty, default values from the announcement title and description will be used. ")],-1)])),_:1,__:[39]}),n(D,null,{default:l(()=>[n(f,{cols:"12"},{default:l(()=>[n(w,{modelValue:t.form.meta_title,"onUpdate:modelValue":e[17]||(e[17]=d=>t.form.meta_title=d),label:"Meta Title",variant:"outlined",hint:"SEO title for search engines (recommended: 50-60 characters)","persistent-hint":"",counter:60,color:s.getMetaTitleColor(),"prepend-inner-icon":"mdi-format-title"},{append:l(()=>[n(y,{icon:"mdi-refresh",size:"small",variant:"text",onClick:s.generateMetaTitle,disabled:!t.form.title,title:"Auto-generate from announcement title"},null,8,["onClick","disabled"])]),_:1},8,["modelValue","color"]),!t.form.meta_title&&s.suggestedMetaTitle?(m(),x(S,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2",closable:""},{default:l(()=>[o("div",he,[o("span",ve,[e[40]||(e[40]=o("strong",null,"Suggested:",-1)),u(" "+c(s.suggestedMetaTitle),1)]),n(y,{size:"small",color:"primary",variant:"text",onClick:s.applySuggestedMetaTitle,class:"ml-2"},{default:l(()=>e[41]||(e[41]=[u(" Apply ")])),_:1,__:[41]},8,["onClick"])])]),_:1})):_("",!0),o("div",{class:z(["text-caption",s.getMetaTitleColor()+"--text"])},[u(c(t.form.meta_title.length)+"/60 characters ",1),t.form.meta_title.length<50?(m(),h("span",ye," (Too short - recommended: 50-60) ")):t.form.meta_title.length>60?(m(),h("span",be," (Too long - may be truncated) ")):t.form.meta_title.length>0?(m(),h("span",we,"✓ Good length")):_("",!0)],2)]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(V,{modelValue:t.form.meta_description,"onUpdate:modelValue":e[18]||(e[18]=d=>t.form.meta_description=d),label:"Meta Description",variant:"outlined",rows:"4",hint:"SEO description for search results (recommended: 150-160 characters)","persistent-hint":"",counter:160,color:s.getMetaDescriptionColor(),"prepend-inner-icon":"mdi-text"},{append:l(()=>[n(y,{icon:"mdi-refresh",size:"small",variant:"text",onClick:s.generateMetaDescription,disabled:!t.form.short_description,title:"Auto-generate from short description"},null,8,["onClick","disabled"])]),_:1},8,["modelValue","color"]),!t.form.meta_description&&s.suggestedMetaDescription?(m(),x(S,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2",closable:""},{default:l(()=>[o("div",xe,[o("span",ke,[e[42]||(e[42]=o("strong",null,"Suggested:",-1)),u(" "+c(s.suggestedMetaDescription),1)]),n(y,{size:"small",color:"primary",variant:"text",onClick:s.applySuggestedMetaDescription},{default:l(()=>e[43]||(e[43]=[u(" Apply ")])),_:1,__:[43]},8,["onClick"])])]),_:1})):_("",!0),o("div",{class:z(["text-caption",s.getMetaDescriptionColor()+"--text"])},[u(c(t.form.meta_description.length)+"/160 characters ",1),t.form.meta_description.length<120?(m(),h("span",De," (Too short - recommended: 150-160) ")):t.form.meta_description.length>160?(m(),h("span",Ie," (Too long - may be truncated) ")):t.form.meta_description.length>0?(m(),h("span",Ve,"✓ Good length")):_("",!0)],2)]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(w,{modelValue:t.form.meta_keywords,"onUpdate:modelValue":e[19]||(e[19]=d=>t.form.meta_keywords=d),label:"Meta Keywords",variant:"outlined",hint:"Comma-separated keywords for SEO (e.g., announcement, company news, event)","persistent-hint":"","prepend-inner-icon":"mdi-tag-multiple"},{append:l(()=>[n(y,{icon:"mdi-auto-fix",size:"small",variant:"text",onClick:s.generateMetaKeywords,disabled:!t.form.title&&!t.form.short_description,title:"Auto-generate from title and description"},null,8,["onClick","disabled"])]),_:1},8,["modelValue"]),!t.form.meta_keywords&&s.suggestedMetaKeywords?(m(),x(S,{key:0,type:"info",variant:"tonal",density:"compact",class:"mt-2",closable:""},{default:l(()=>[o("div",Se,[o("span",Ae,[e[44]||(e[44]=o("strong",null,"Suggested:",-1)),u(" "+c(s.suggestedMetaKeywords),1)]),n(y,{size:"small",color:"primary",variant:"text",onClick:s.applySuggestedMetaKeywords},{default:l(()=>e[45]||(e[45]=[u(" Apply ")])),_:1,__:[45]},8,["onClick"])])]),_:1})):_("",!0),o("div",Te,c((t.form.meta_keywords||"").split(",").filter(d=>d.trim()).length)+" keywords entered ",1)]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(C,{class:"my-4"}),e[46]||(e[46]=o("h3",{class:"text-h6 font-weight-bold mb-4"},"Open Graph (Social Media)",-1)),e[47]||(e[47]=o("p",{class:"text-body-2 text-medium-emphasis mb-4"}," This image will be displayed when your announcement is shared on social media platforms like Facebook, Twitter, LinkedIn, etc. ",-1))]),_:1,__:[46,47]}),n(f,{cols:"12"},{default:l(()=>[n(F,{class:"mb-2"},{default:l(()=>e[48]||(e[48]=[u("Open Graph Image")])),_:1,__:[48]}),n(E,{variant:"outlined",class:"pa-4"},{default:l(()=>[o("div",Pe,[t.ogImagePreview||t.form.og_image?(m(),h("div",Ce,[n(U,{src:t.ogImagePreview||s.resolveImageUrl(t.form.og_image),"max-width":"300","max-height":"300",class:"rounded elevation-2",cover:""},null,8,["src"]),o("div",Fe,[n(y,{color:"error",size:"small",variant:"text",onClick:s.removeOgImage,"prepend-icon":"mdi-delete"},{default:l(()=>e[49]||(e[49]=[u(" Remove Image ")])),_:1,__:[49]},8,["onClick"])]),e[50]||(e[50]=o("div",{class:"text-caption text-medium-emphasis mt-2"}," Recommended: 1200x630px (1.91:1 ratio) ",-1))])):_("",!0),o("div",Me,[n(g,{modelValue:t.ogImageFile,"onUpdate:modelValue":[e[20]||(e[20]=d=>t.ogImageFile=d),s.handleOgImageSelect],accept:"image/*",label:"Select Open Graph Image",variant:"outlined","prepend-icon":"","prepend-inner-icon":"mdi-image","show-size":"",clearable:"",hint:"Recommended size: 1200x630px. Max file size: 5MB","persistent-hint":""},{append:l(()=>[t.uploadingOgImage?(m(),x(I,{key:0,indeterminate:"",color:"primary",size:"24"})):_("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"]),t.ogImageFile&&t.ogImageFile.size>5242880?(m(),x(S,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mt-2"},{default:l(()=>e[51]||(e[51]=[u(" File size is larger than 5MB. Please choose a smaller image. ")])),_:1,__:[51]})):_("",!0),t.ogImageError?(m(),x(S,{key:1,type:"error",variant:"tonal",density:"compact",class:"mt-2",closable:"","onClick:close":e[21]||(e[21]=d=>t.ogImageError=null)},{default:l(()=>[o("div",Ue,[e[52]||(e[52]=o("strong",null,"Upload Error:",-1)),u(" "+c(t.ogImageError),1)])]),_:1})):_("",!0),!t.ogImagePreview&&!t.ogImageFile?(m(),h("div",Ee," No image selected. If not provided, the announcement image will be used. ")):_("",!0)])])]),_:1})]),_:1}),n(f,{cols:"12"},{default:l(()=>[n(C,{class:"my-4"}),e[53]||(e[53]=o("h3",{class:"text-h6 font-weight-bold mb-4"},"Search Engine Preview",-1)),n(E,{variant:"outlined",class:"pa-4"},{default:l(()=>[o("div",Oe,[o("div",ze,c(s.getPreviewUrl()),1),o("div",{class:z(["search-title mb-1 text-h6",s.getMetaTitleColor()+"--text"]),style:{color:"#1a0dab",cursor:"pointer"}},c(s.getPreviewTitle()),3),o("div",{class:z(["search-description text-body-2",s.getMetaDescriptionColor()+"--text"]),style:{color:"#545454"}},c(s.getPreviewDescription()),3)])]),_:1})]),_:1,__:[53]})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),_:1},512))]),_:1}),n(C),n(q,{class:"pa-4"},{default:l(()=>[n(G),n(y,{color:"grey",variant:"text",onClick:s.closeDialog,disabled:t.saving},{default:l(()=>e[54]||(e[54]=[u(" Cancel ")])),_:1,__:[54]},8,["onClick","disabled"]),n(y,{color:"primary",variant:"elevated",onClick:s.saveAnnouncement,loading:t.saving,disabled:t.loading},{default:l(()=>[u(c(r.editingAnnouncement?"Update":"Create")+" Announcement ",1)]),_:1},8,["onClick","loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const Le=L(ae,[["render",Be],["__scopeId","data-v-1fcc6783"]]),Ne={name:"AnnouncementDetailsDialog",props:{modelValue:{type:Boolean,default:!1},announcementId:{type:[Number,String],default:null}},emits:["update:modelValue","edit"],data(){return{loading:!1,announcement:null,tab:"basic"}},computed:{dialog:{get(){return this.modelValue},set(i){this.$emit("update:modelValue",i)}}},watch:{modelValue(i){i&&this.announcementId&&this.loadAnnouncement()},announcementId(){this.dialog&&this.announcementId&&this.loadAnnouncement()}},methods:{resolveImageUrl(i){return R(i)},async loadAnnouncement(){if(this.announcementId){this.loading=!0,this.announcement=null,this.tab="basic";try{const e=(await this.$axios.get(`/api/v1/announcements/${this.announcementId}`,{headers:this.getAuthHeaders()})).data;if(!e)throw new Error("No announcement data received");this.announcement=e}catch(i){console.error("Failed to load announcement details:",i),this.showError("Failed to load announcement details. Please try again."),this.closeDialog()}finally{this.loading=!1}}},closeDialog(){this.dialog=!1,this.announcement=null,this.tab="basic"},handleEdit(){this.announcement&&(this.$emit("edit",this.announcement),this.closeDialog())},getAuthHeaders(){return{Authorization:`Bearer ${localStorage.getItem("admin_token")}`}},formatDateTime(i){return i?new Date(i).toLocaleString():"-"},formatType(i){return{company_news:"Company News",offers_promotions:"Offers / Promotions",events:"Events",holidays:"Holidays",urgent_alerts:"Urgent Alerts"}[i]||i},getTypeColor(i){return{company_news:"primary",offers_promotions:"success",events:"info",holidays:"warning",urgent_alerts:"error"}[i]||"grey"},formatDisplayType(i){return{slider_banner:"Slider Banner",popup:"Popup",sidebar_ticker:"Sidebar Ticker",page_section:"Page Section"}[i]||i},showError(i){this.$swal?this.$swal.fire({icon:"error",title:"Error",text:i}):alert(i)}}},He={class:"d-flex align-center"},Re={key:0,class:"d-flex align-center justify-center pa-12"},je={class:"text-center"},Ke={key:1},We={class:"text-h6 font-weight-bold mb-4"},Ge={class:"text-body-1 mb-4"},qe={class:"text-body-1 mb-4"},Ye={class:"text-body-1 mb-4"},Je={class:"text-body-1 mb-4"},Qe={class:"text-body-1 mb-4"},Xe={class:"mb-4"},Ze={class:"text-body-1 mb-4"},$e={class:"text-body-1 mb-4"},et={class:"text-body-1 mb-4"},tt={class:"text-body-1 mb-4"},nt=["href"],it=["innerHTML"],lt={class:"text-body-1 mb-4"},ot=["href","target"],st={class:"text-body-1 mb-4"},at={class:"text-body-1 mb-4"},rt={class:"text-body-1 mb-4"},dt={class:"text-body-1 mb-4"},mt={class:"text-body-1 mb-4"},ut={class:"text-body-1 mb-4"};function ct(i,e,r,p,t,s){const y=a("v-icon"),A=a("v-btn"),I=a("v-card-title"),k=a("v-progress-circular"),T=a("v-tab"),w=a("v-tabs"),f=a("v-divider"),v=a("v-col"),V=a("v-chip"),D=a("v-row"),b=a("v-window-item"),F=a("v-img"),P=a("v-window"),C=a("v-card-text"),U=a("v-spacer"),g=a("v-card-actions"),S=a("v-card"),E=a("v-dialog");return m(),x(E,{modelValue:s.dialog,"onUpdate:modelValue":e[2]||(e[2]=M=>s.dialog=M),"max-width":"1200",scrollable:""},{default:l(()=>[n(S,null,{default:l(()=>[n(I,{class:"d-flex align-center justify-space-between bg-info text-white pa-4"},{default:l(()=>[o("div",He,[n(y,{icon:"mdi-eye",class:"mr-3"}),e[3]||(e[3]=o("span",{class:"text-h5 font-weight-bold"},"Announcement Details",-1))]),n(A,{icon:"mdi-close",variant:"text",color:"white",onClick:s.closeDialog,disabled:t.loading},null,8,["onClick","disabled"])]),_:1}),n(C,{class:"pa-0"},{default:l(()=>[t.loading?(m(),h("div",Re,[o("div",je,[n(k,{indeterminate:"",color:"info",size:"64"}),e[4]||(e[4]=o("p",{class:"text-body-1 text-medium-emphasis mt-4"},"Loading announcement details...",-1))])])):t.announcement?(m(),h("div",Ke,[n(w,{modelValue:t.tab,"onUpdate:modelValue":e[0]||(e[0]=M=>t.tab=M),color:"info","bg-color":"grey-lighten-4"},{default:l(()=>[n(T,{value:"basic"},{default:l(()=>[n(y,{icon:"mdi-information",class:"mr-2"}),e[5]||(e[5]=u(" Basic Info "))]),_:1,__:[5]}),n(T,{value:"content"},{default:l(()=>[n(y,{icon:"mdi-text",class:"mr-2"}),e[6]||(e[6]=u(" Content "))]),_:1,__:[6]}),n(T,{value:"settings"},{default:l(()=>[n(y,{icon:"mdi-cog",class:"mr-2"}),e[7]||(e[7]=u(" Settings "))]),_:1,__:[7]}),n(T,{value:"seo"},{default:l(()=>[n(y,{icon:"mdi-search-web",class:"mr-2"}),e[8]||(e[8]=u(" SEO & Meta "))]),_:1,__:[8]})]),_:1},8,["modelValue"]),n(f),n(P,{modelValue:t.tab,"onUpdate:modelValue":e[1]||(e[1]=M=>t.tab=M),class:"pa-6"},{default:l(()=>[n(b,{value:"basic"},{default:l(()=>[n(D,null,{default:l(()=>[n(v,{cols:"12"},{default:l(()=>[e[9]||(e[9]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Title",-1)),o("div",We,c(t.announcement.title||"-"),1)]),_:1,__:[9]}),n(v,{cols:"12",md:"6"},{default:l(()=>[e[10]||(e[10]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Slug",-1)),o("div",Ge,[n(V,{size:"small",variant:"outlined"},{default:l(()=>[u(c(t.announcement.slug||"-"),1)]),_:1})])]),_:1,__:[10]}),n(v,{cols:"12",md:"6"},{default:l(()=>[e[11]||(e[11]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Type",-1)),o("div",qe,[n(V,{size:"small",color:s.getTypeColor(t.announcement.type)},{default:l(()=>[u(c(s.formatType(t.announcement.type)),1)]),_:1},8,["color"])])]),_:1,__:[11]}),n(v,{cols:"12",md:"6"},{default:l(()=>[e[12]||(e[12]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Display Type",-1)),o("div",Ye,[n(V,{size:"small",variant:"outlined"},{default:l(()=>[u(c(s.formatDisplayType(t.announcement.display_type)),1)]),_:1})])]),_:1,__:[12]}),n(v,{cols:"12",md:"6"},{default:l(()=>[e[13]||(e[13]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Priority",-1)),o("div",Je,[n(V,{size:"small",color:t.announcement.priority>50?"error":t.announcement.priority>20?"warning":"info"},{default:l(()=>[u(c(t.announcement.priority),1)]),_:1},8,["color"])])]),_:1,__:[13]}),n(v,{cols:"12"},{default:l(()=>[e[14]||(e[14]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Short Description",-1)),o("div",Qe,c(t.announcement.short_description||"-"),1)]),_:1,__:[14]}),n(v,{cols:"12"},{default:l(()=>[e[15]||(e[15]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Status",-1)),o("div",Xe,[n(V,{color:t.announcement.is_active?"success":"error",size:"small"},{default:l(()=>[u(c(t.announcement.is_active?"Active":"Inactive"),1)]),_:1},8,["color"])])]),_:1,__:[15]}),t.announcement.language?(m(),x(v,{key:0,cols:"12"},{default:l(()=>[e[16]||(e[16]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Language",-1)),o("div",Ze,c(t.announcement.language),1)]),_:1,__:[16]})):_("",!0),t.announcement.created_at?(m(),x(v,{key:1,cols:"12"},{default:l(()=>[e[17]||(e[17]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Created At",-1)),o("div",$e,c(s.formatDateTime(t.announcement.created_at)),1)]),_:1,__:[17]})):_("",!0),t.announcement.updated_at?(m(),x(v,{key:2,cols:"12"},{default:l(()=>[e[18]||(e[18]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Updated At",-1)),o("div",et,c(s.formatDateTime(t.announcement.updated_at)),1)]),_:1,__:[18]})):_("",!0)]),_:1})]),_:1}),n(b,{value:"content"},{default:l(()=>[n(D,null,{default:l(()=>[t.announcement.image?(m(),x(v,{key:0,cols:"12"},{default:l(()=>[e[19]||(e[19]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Image",-1)),n(F,{src:s.resolveImageUrl(t.announcement.image),"max-width":"600","max-height":"400",class:"rounded elevation-2 mb-4",cover:""},null,8,["src"])]),_:1,__:[19]})):_("",!0),t.announcement.video?(m(),x(v,{key:1,cols:"12"},{default:l(()=>[e[20]||(e[20]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Video",-1)),o("div",tt,[o("a",{href:s.resolveImageUrl(t.announcement.video),target:"_blank",class:"text-decoration-none"},c(t.announcement.video),9,nt)])]),_:1,__:[20]})):_("",!0),n(v,{cols:"12"},{default:l(()=>[e[21]||(e[21]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Content",-1)),o("div",{class:"text-body-1",innerHTML:t.announcement.content||"-"},null,8,it)]),_:1,__:[21]}),t.announcement.external_link?(m(),x(v,{key:2,cols:"12"},{default:l(()=>[e[22]||(e[22]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"External Link",-1)),o("div",lt,[o("a",{href:t.announcement.external_link,target:t.announcement.open_in_new_tab?"_blank":"_self",class:"text-decoration-none"},[u(c(t.announcement.external_link)+" ",1),t.announcement.open_in_new_tab?(m(),x(y,{key:0,icon:"mdi-open-in-new",size:"small"})):_("",!0)],8,ot)])]),_:1,__:[22]})):_("",!0)]),_:1})]),_:1}),n(b,{value:"settings"},{default:l(()=>[n(D,null,{default:l(()=>[t.announcement.start_date?(m(),x(v,{key:0,cols:"12",md:"6"},{default:l(()=>[e[23]||(e[23]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Start Date & Time",-1)),o("div",st,c(s.formatDateTime(t.announcement.start_date)),1)]),_:1,__:[23]})):_("",!0),t.announcement.end_date?(m(),x(v,{key:1,cols:"12",md:"6"},{default:l(()=>[e[24]||(e[24]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"End Date & Time",-1)),o("div",at,c(s.formatDateTime(t.announcement.end_date)),1)]),_:1,__:[24]})):_("",!0),t.announcement.author?(m(),x(v,{key:2,cols:"12"},{default:l(()=>[e[25]||(e[25]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Author",-1)),o("div",rt,c(t.announcement.author.name||t.announcement.author.email||"-"),1)]),_:1,__:[25]})):_("",!0)]),_:1})]),_:1}),n(b,{value:"seo"},{default:l(()=>[n(D,null,{default:l(()=>[n(v,{cols:"12"},{default:l(()=>[e[26]||(e[26]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Meta Title",-1)),o("div",dt,c(t.announcement.meta_title||"-"),1)]),_:1,__:[26]}),n(v,{cols:"12"},{default:l(()=>[e[27]||(e[27]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Meta Description",-1)),o("div",mt,c(t.announcement.meta_description||"-"),1)]),_:1,__:[27]}),n(v,{cols:"12"},{default:l(()=>[e[28]||(e[28]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Meta Keywords",-1)),o("div",ut,c(t.announcement.meta_keywords||"-"),1)]),_:1,__:[28]}),t.announcement.og_image?(m(),x(v,{key:0,cols:"12"},{default:l(()=>[e[29]||(e[29]=o("div",{class:"text-subtitle-1 text-medium-emphasis mb-2"},"Open Graph Image",-1)),n(F,{src:s.resolveImageUrl(t.announcement.og_image),"max-width":"600","max-height":"400",class:"rounded elevation-2 mb-4",cover:""},null,8,["src"])]),_:1,__:[29]})):_("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])])):_("",!0)]),_:1}),n(g,{class:"pa-4 bg-grey-lighten-5"},{default:l(()=>[n(U),n(A,{color:"primary","prepend-icon":"mdi-pencil",onClick:s.handleEdit},{default:l(()=>e[30]||(e[30]=[u(" Edit Announcement ")])),_:1,__:[30]},8,["onClick"]),n(A,{color:"grey",variant:"text",onClick:s.closeDialog},{default:l(()=>e[31]||(e[31]=[u("Close")])),_:1,__:[31]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const gt=L(Ne,[["render",ct]]),pt={components:{AnnouncementFormDialog:Le,AnnouncementDetailsDialog:gt},mixins:[H],data(){return{announcements:[],showDialog:!1,editingAnnouncement:null,showDetailsDialog:!1,selectedAnnouncementId:null,statusFilter:null,statusOptions:[{title:"Active",value:!0},{title:"Inactive",value:!1}],typeFilter:null,typeOptions:[{title:"Company News",value:"company_news"},{title:"Offers / Promotions",value:"offers_promotions"},{title:"Events",value:"events"},{title:"Holidays",value:"holidays"},{title:"Urgent Alerts",value:"urgent_alerts"}]}},async mounted(){await this.loadAnnouncements()},methods:{async loadAnnouncements(){try{this.loading=!0;const i=this.buildPaginationParams();this.search&&(i.search=this.search),this.statusFilter!==null&&(i.is_active=this.statusFilter),this.typeFilter&&(i.type=this.typeFilter);const e=await this.$axios.get("/api/v1/announcements",{params:i,headers:this.getAuthHeaders()});this.announcements=e.data.data||[],this.updatePagination(e.data)}catch(i){this.handleApiError(i,"Failed to load announcements")}finally{this.loading=!1}},openDialog(i=null){this.editingAnnouncement=i,this.showDialog=!0},editAnnouncement(i){this.openDialog(i)},viewAnnouncement(i){this.selectedAnnouncementId=i.id,this.showDetailsDialog=!0},handleEditFromDetails(i){this.showDetailsDialog=!1,this.$nextTick(()=>{this.openDialog(i)})},handleAnnouncementSaved(){this.loadAnnouncements()},async toggleStatus(i){try{await this.$axios.put(`/api/v1/announcements/${i.id}/toggle-status`,{},{headers:this.getAuthHeaders()}),this.showSuccess("Announcement status updated successfully"),await this.loadAnnouncements()}catch(e){this.handleApiError(e,"Error updating announcement status")}},async deleteAnnouncement(i){if((await this.$swal.fire({title:"Are you sure?",text:"This action cannot be undone!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await this.$axios.delete(`/api/v1/announcements/${i}`,{headers:this.getAuthHeaders()}),this.showSuccess("Announcement deleted successfully"),await this.loadAnnouncements()}catch(r){this.handleApiError(r,"Error deleting announcement")}},formatType(i){return{company_news:"Company News",offers_promotions:"Offers / Promotions",events:"Events",holidays:"Holidays",urgent_alerts:"Urgent Alerts"}[i]||i},getTypeColor(i){return{company_news:"primary",offers_promotions:"success",events:"info",holidays:"warning",urgent_alerts:"error"}[i]||"grey"},formatDisplayType(i){return{slider_banner:"Slider Banner",popup:"Popup",sidebar_ticker:"Sidebar Ticker",page_section:"Page Section"}[i]||i},formatDate(i){if(!i)return"";const e=new Date(i);return e.toLocaleDateString()+" "+e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},onPerPageChange(){this.resetPagination(),this.loadAnnouncements()},onSort(i){this.handleSort(i),this.loadAnnouncements()}}},ft={class:"page-header"},_t={class:"text-caption text-grey"},ht={key:0},vt={class:"d-flex align-center"},yt={class:"d-flex align-center"},bt={class:"d-flex align-center"},wt={class:"d-flex"},xt={class:"font-weight-medium"},kt={class:"text-caption text-grey"},Dt={class:"text-caption"},It={key:0},Vt={key:1},St={key:2,class:"text-grey"},At={key:0},Tt={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},Pt={class:"text-caption text-grey"},Ct={key:0},Ft={key:0,class:"ml-2"},Mt={key:1},Ut={key:0,class:"d-flex align-center gap-2"};function Et(i,e,r,p,t,s){const y=a("v-btn"),A=a("v-select"),I=a("v-col"),k=a("v-text-field"),T=a("v-row"),w=a("v-card-text"),f=a("v-card"),v=a("v-card-title"),V=a("v-icon"),D=a("v-skeleton-loader"),b=a("v-chip"),F=a("v-table"),P=a("v-pagination"),C=a("AnnouncementFormDialog"),U=a("AnnouncementDetailsDialog");return m(),h("div",null,[o("div",ft,[e[12]||(e[12]=o("h1",{class:"text-h4 page-title"},"Announcements Management",-1)),n(y,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=g=>s.openDialog()),class:"add-button"},{default:l(()=>e[11]||(e[11]=[u(" Create Announcement ")])),_:1,__:[11]})]),n(f,{class:"mb-4"},{default:l(()=>[n(w,null,{default:l(()=>[n(T,null,{default:l(()=>[n(I,{cols:"12",md:"3"},{default:l(()=>[n(A,{modelValue:i.perPage,"onUpdate:modelValue":[e[1]||(e[1]=g=>i.perPage=g),s.onPerPageChange],items:i.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),n(I,{cols:"12",md:"3"},{default:l(()=>[n(A,{modelValue:t.statusFilter,"onUpdate:modelValue":[e[2]||(e[2]=g=>t.statusFilter=g),s.loadAnnouncements],items:t.statusOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),n(I,{cols:"12",md:"3"},{default:l(()=>[n(A,{modelValue:t.typeFilter,"onUpdate:modelValue":[e[3]||(e[3]=g=>t.typeFilter=g),s.loadAnnouncements],items:t.typeOptions,label:"Filter by Type","prepend-inner-icon":"mdi-tag",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),n(I,{cols:"12",md:"3"},{default:l(()=>[n(k,{modelValue:i.search,"onUpdate:modelValue":[e[4]||(e[4]=g=>i.search=g),s.loadAnnouncements],label:"Search announcements","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),n(f,null,{default:l(()=>[n(v,{class:"d-flex justify-space-between align-center"},{default:l(()=>[e[14]||(e[14]=o("span",null,"Announcements",-1)),o("span",_t,[e[13]||(e[13]=u(" Total Records: ")),o("strong",null,c(i.pagination.total||0),1),t.announcements.length>0?(m(),h("span",ht," | Showing "+c((i.currentPage-1)*i.perPage+1)+" to "+c(Math.min(i.currentPage*i.perPage,i.pagination.total))+" of "+c(i.pagination.total),1)):_("",!0)])]),_:1,__:[14]}),n(w,null,{default:l(()=>[n(F,null,{default:l(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:e[5]||(e[5]=g=>s.onSort("title"))},[o("div",vt,[e[15]||(e[15]=u(" Title ")),n(V,{icon:i.getSortIcon("title"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[18]||(e[18]=o("th",null,"Type",-1)),e[19]||(e[19]=o("th",null,"Display Type",-1)),o("th",{class:"sortable",onClick:e[6]||(e[6]=g=>s.onSort("priority"))},[o("div",yt,[e[16]||(e[16]=u(" Priority ")),n(V,{icon:i.getSortIcon("priority"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[20]||(e[20]=o("th",null,"Date Range",-1)),o("th",{class:"sortable",onClick:e[7]||(e[7]=g=>s.onSort("is_active"))},[o("div",bt,[e[17]||(e[17]=u(" Status ")),n(V,{icon:i.getSortIcon("is_active"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[21]||(e[21]=o("th",null,"Actions",-1))])]),o("tbody",null,[i.loading?(m(),h(O,{key:0},B(5,g=>o("tr",{key:`skeleton-${g}`},[o("td",null,[n(D,{type:"text",width:"200"})]),o("td",null,[n(D,{type:"chip",width:"100"})]),o("td",null,[n(D,{type:"chip",width:"100"})]),o("td",null,[n(D,{type:"text",width:"60"})]),o("td",null,[n(D,{type:"text",width:"150"})]),o("td",null,[n(D,{type:"chip",width:"80"})]),o("td",null,[o("div",wt,[n(D,{type:"button",width:"32",height:"32",class:"mr-1"}),n(D,{type:"button",width:"32",height:"32",class:"mr-1"}),n(D,{type:"button",width:"32",height:"32"})])])])),64)):(m(),h(O,{key:1},[(m(!0),h(O,null,B(t.announcements,g=>(m(),h("tr",{key:g.id},[o("td",null,[o("div",xt,c(g.title),1),o("div",kt,c(g.slug),1)]),o("td",null,[n(b,{size:"small",color:s.getTypeColor(g.type)},{default:l(()=>[u(c(s.formatType(g.type)),1)]),_:2},1032,["color"])]),o("td",null,[n(b,{size:"small",variant:"outlined"},{default:l(()=>[u(c(s.formatDisplayType(g.display_type)),1)]),_:2},1024)]),o("td",null,[n(b,{size:"small",color:g.priority>50?"error":g.priority>20?"warning":"info"},{default:l(()=>[u(c(g.priority),1)]),_:2},1032,["color"])]),o("td",null,[o("div",Dt,[g.start_date?(m(),h("div",It,[e[22]||(e[22]=o("strong",null,"Start:",-1)),u(" "+c(s.formatDate(g.start_date)),1)])):_("",!0),g.end_date?(m(),h("div",Vt,[e[23]||(e[23]=o("strong",null,"End:",-1)),u(" "+c(s.formatDate(g.end_date)),1)])):_("",!0),!g.start_date&&!g.end_date?(m(),h("div",St," No date range ")):_("",!0)])]),o("td",null,[n(b,{color:g.is_active?"success":"error",size:"small"},{default:l(()=>[u(c(g.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),o("td",null,[n(y,{size:"small",icon:"mdi-eye",onClick:S=>s.viewAnnouncement(g),variant:"text",color:"info",title:"View"},null,8,["onClick"]),n(y,{size:"small",icon:"mdi-pencil",onClick:S=>s.editAnnouncement(g),variant:"text",title:"Edit"},null,8,["onClick"]),n(y,{size:"small",icon:g.is_active?"mdi-pause":"mdi-play",onClick:S=>s.toggleStatus(g),variant:"text",color:g.is_active?"warning":"success",title:g.is_active?"Deactivate":"Activate"},null,8,["icon","onClick","color","title"]),n(y,{size:"small",icon:"mdi-delete",onClick:S=>s.deleteAnnouncement(g.id),variant:"text",color:"error",title:"Delete"},null,8,["onClick"])])]))),128)),t.announcements.length===0?(m(),h("tr",At,e[24]||(e[24]=[o("td",{colspan:"7",class:"text-center py-4"},"No announcements found",-1)]))):_("",!0)],64))])]),_:1}),o("div",Tt,[o("div",Pt,[t.announcements.length>0&&i.pagination.total>0?(m(),h("span",Ct,[e[25]||(e[25]=u(" Showing ")),o("strong",null,c((i.currentPage-1)*i.perPage+1),1),e[26]||(e[26]=u(" to ")),o("strong",null,c(Math.min(i.currentPage*i.perPage,i.pagination.total)),1),e[27]||(e[27]=u(" of ")),o("strong",null,c(i.pagination.total.toLocaleString()),1),e[28]||(e[28]=u(" records ")),i.pagination.last_page>1?(m(),h("span",Ft," (Page "+c(i.currentPage)+" of "+c(i.pagination.last_page)+") ",1)):_("",!0)])):(m(),h("span",Mt,"No records found"))]),i.pagination.last_page>1?(m(),h("div",Ut,[n(P,{modelValue:i.currentPage,"onUpdate:modelValue":[e[8]||(e[8]=g=>i.currentPage=g),s.loadAnnouncements],length:i.pagination.last_page,"total-visible":7,density:"comfortable"},null,8,["modelValue","length","onUpdate:modelValue"])])):_("",!0)])]),_:1})]),_:1}),n(C,{modelValue:t.showDialog,"onUpdate:modelValue":e[9]||(e[9]=g=>t.showDialog=g),"editing-announcement":t.editingAnnouncement,onSaved:s.handleAnnouncementSaved},null,8,["modelValue","editing-announcement","onSaved"]),n(U,{modelValue:t.showDetailsDialog,"onUpdate:modelValue":e[10]||(e[10]=g=>t.showDetailsDialog=g),"announcement-id":t.selectedAnnouncementId,onEdit:s.handleEditFromDetails},null,8,["modelValue","announcement-id","onEdit"])])}const Nt=L(pt,[["render",Et]]);export{Nt as default};
