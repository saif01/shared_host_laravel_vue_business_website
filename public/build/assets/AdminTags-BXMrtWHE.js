import{_ as H,d as g,a as o,b as l,w as n,f as u,r,h as w,t as d,F as C,e as F,g as y,o as p}from"./app-D_WvYKr6.js";import{a as L}from"./adminPaginationMixin-DN7Wb3ng.js";const M={mixins:[L],data(){return{tags:[],showDialog:!1,editingTag:null,saving:!1,typeFilter:null,typeOptions:[{title:"Product",value:"product"},{title:"Service",value:"service"},{title:"Post",value:"post"},{title:"General",value:"general"}],form:{name:"",slug:"",type:"product",description:""}}},async mounted(){await this.loadTags()},methods:{async loadTags(){try{this.loading=!0;const t=this.buildPaginationParams();this.search&&(t.search=this.search),this.typeFilter&&(t.type=this.typeFilter);const e=await y.get("/api/v1/tags",{params:t,headers:this.getAuthHeaders()});this.tags=e.data.data||[],this.updatePagination(e.data)}catch(t){this.handleApiError(t,"Failed to load tags")}finally{this.loading=!1}},async openDialog(t=null){if(this.editingTag=t,this.showDialog=!0,t)try{await this.loadTagForEdit(t)}catch(e){console.error("Error loading tag for edit:",e)}else this.resetForm()},async loadTagForEdit(t){var e;try{const m=await y.get(`/api/v1/tags/${t.id}`,{headers:this.getAuthHeaders()}),c=((e=m.data)==null?void 0:e.data)||m.data;if(!c)throw new Error("No tag data received from server");this.form={name:c.name||"",slug:c.slug||"",type:c.type||"product",description:c.description||""}}catch(m){throw this.handleApiError(m,"Failed to load tag"),m}},resetForm(){this.form={name:"",slug:"",type:this.typeFilter||"product",description:""}},generateSlug(){this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""))},async saveTag(){const{valid:t}=await this.$refs.formRef.validate();if(!t){this.showError("Please fill in all required fields");return}try{this.saving=!0;const e={name:this.form.name,type:this.form.type,description:this.form.description||null};this.form.slug&&(e.slug=this.form.slug),this.editingTag?(await y.put(`/api/v1/tags/${this.editingTag.id}`,e,{headers:this.getAuthHeaders()}),this.showSuccess("Tag updated successfully")):(await y.post("/api/v1/tags",e,{headers:this.getAuthHeaders()}),this.showSuccess("Tag created successfully")),this.closeDialog(),await this.loadTags()}catch(e){this.handleApiError(e,"Failed to save tag")}finally{this.saving=!1}},editTag(t){this.openDialog(t)},async deleteTag(t){var e,m,c,s;if(confirm("Are you sure you want to delete this tag? This action cannot be undone."))try{await y.delete(`/api/v1/tags/${t}`,{headers:this.getAuthHeaders()}),this.showSuccess("Tag deleted successfully"),await this.loadTags()}catch(i){const f=((m=(e=i.response)==null?void 0:e.data)==null?void 0:m.error)||((s=(c=i.response)==null?void 0:c.data)==null?void 0:s.message)||"Error deleting tag";this.showError(f)}},closeDialog(){this.showDialog=!1,this.editingTag=null,this.resetForm(),this.$refs.formRef&&this.$refs.formRef.resetValidation()},onPerPageChange(){this.resetPagination(),this.loadTags()},onSort(t){this.handleSort(t),this.loadTags()}}},B={class:"page-header"},O={class:"text-caption text-grey"},j={key:0},q={class:"d-flex align-center"},G={class:"d-flex align-center"},J={class:"d-flex align-center"},K={class:"d-flex align-center"},Q={class:"d-flex"},W={class:"font-weight-medium"},X={key:0,class:"text-body-2"},Y={key:1,class:"text-caption text-grey"},Z={class:"text-caption"},$={key:0},ee={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},te={class:"text-caption text-grey"},le={key:0},ae={key:0,class:"ml-2"},oe={key:1},ne={key:0,class:"d-flex align-center gap-2"},se={class:"text-h5 font-weight-bold"};function ie(t,e,m,c,s,i){const f=r("v-btn"),T=r("v-select"),h=r("v-col"),b=r("v-text-field"),P=r("v-row"),V=r("v-card-text"),k=r("v-card"),S=r("v-card-title"),_=r("v-icon"),v=r("v-skeleton-loader"),D=r("v-chip"),x=r("v-table"),U=r("v-pagination"),E=r("v-textarea"),N=r("v-form"),z=r("v-spacer"),A=r("v-card-actions"),I=r("v-dialog");return p(),g("div",null,[o("div",B,[e[15]||(e[15]=o("h1",{class:"text-h4 page-title"},"Tags Management",-1)),l(f,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=a=>i.openDialog()),class:"add-button"},{default:n(()=>e[14]||(e[14]=[u("Create Tag")])),_:1,__:[14]})]),l(k,{class:"mb-4"},{default:n(()=>[l(V,null,{default:n(()=>[l(P,null,{default:n(()=>[l(h,{cols:"12",md:"3"},{default:n(()=>[l(T,{modelValue:t.perPage,"onUpdate:modelValue":[e[1]||(e[1]=a=>t.perPage=a),i.onPerPageChange],items:t.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(h,{cols:"12",md:"3"},{default:n(()=>[l(T,{modelValue:s.typeFilter,"onUpdate:modelValue":[e[2]||(e[2]=a=>s.typeFilter=a),i.loadTags],items:s.typeOptions,label:"Filter by Type","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(h,{cols:"12",md:"6"},{default:n(()=>[l(b,{modelValue:t.search,"onUpdate:modelValue":[e[3]||(e[3]=a=>t.search=a),i.loadTags],label:"Search tags","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(k,null,{default:n(()=>[l(S,{class:"d-flex justify-space-between align-center"},{default:n(()=>[e[17]||(e[17]=o("span",null,"Tags",-1)),o("span",O,[e[16]||(e[16]=u(" Total Records: ")),o("strong",null,d(t.pagination.total||0),1),s.tags.length>0?(p(),g("span",j," | Showing "+d((t.currentPage-1)*t.perPage+1)+" to "+d(Math.min(t.currentPage*t.perPage,t.pagination.total))+" of "+d(t.pagination.total),1)):w("",!0)])]),_:1,__:[17]}),l(V,null,{default:n(()=>[l(x,null,{default:n(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:e[4]||(e[4]=a=>i.onSort("name"))},[o("div",q,[e[18]||(e[18]=u(" Name ")),l(_,{icon:t.getSortIcon("name"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[5]||(e[5]=a=>i.onSort("slug"))},[o("div",G,[e[19]||(e[19]=u(" Slug ")),l(_,{icon:t.getSortIcon("slug"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[6]||(e[6]=a=>i.onSort("type"))},[o("div",J,[e[20]||(e[20]=u(" Type ")),l(_,{icon:t.getSortIcon("type"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[22]||(e[22]=o("th",null,"Description",-1)),o("th",{class:"sortable",onClick:e[7]||(e[7]=a=>i.onSort("created_at"))},[o("div",K,[e[21]||(e[21]=u(" Created ")),l(_,{icon:t.getSortIcon("created_at"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[23]||(e[23]=o("th",null,"Actions",-1))])]),o("tbody",null,[t.loading?(p(),g(C,{key:0},F(5,a=>o("tr",{key:`skeleton-${a}`},[o("td",null,[l(v,{type:"text",width:"150"})]),o("td",null,[l(v,{type:"chip",width:"120",height:"24"})]),o("td",null,[l(v,{type:"chip",width:"80",height:"24"})]),o("td",null,[l(v,{type:"text",width:"200"})]),o("td",null,[l(v,{type:"text",width:"100"})]),o("td",null,[o("div",Q,[l(v,{type:"button",width:"32",height:"32",class:"mr-1"}),l(v,{type:"button",width:"32",height:"32"})])])])),64)):(p(),g(C,{key:1},[(p(!0),g(C,null,F(s.tags,a=>(p(),g("tr",{key:a.id},[o("td",null,[o("div",W,d(a.name),1)]),o("td",null,[l(D,{size:"small",variant:"outlined"},{default:n(()=>[u(d(a.slug),1)]),_:2},1024)]),o("td",null,[l(D,{size:"small",color:"primary",variant:"tonal"},{default:n(()=>[u(d(a.type),1)]),_:2},1024)]),o("td",null,[a.description?(p(),g("span",X,d(a.description),1)):(p(),g("span",Y,"No description"))]),o("td",null,[o("span",Z,d(a.created_at?new Date(a.created_at).toLocaleDateString():"-"),1)]),o("td",null,[l(f,{size:"small",icon:"mdi-pencil",onClick:R=>i.editTag(a),variant:"text",color:"primary"},null,8,["onClick"]),l(f,{size:"small",icon:"mdi-delete",onClick:R=>i.deleteTag(a.id),variant:"text",color:"error"},null,8,["onClick"])])]))),128)),s.tags.length===0?(p(),g("tr",$,e[24]||(e[24]=[o("td",{colspan:"6",class:"text-center py-4"},"No tags found",-1)]))):w("",!0)],64))])]),_:1}),o("div",ee,[o("div",te,[s.tags.length>0&&t.pagination.total>0?(p(),g("span",le,[e[25]||(e[25]=u(" Showing ")),o("strong",null,d((t.currentPage-1)*t.perPage+1),1),e[26]||(e[26]=u(" to ")),o("strong",null,d(Math.min(t.currentPage*t.perPage,t.pagination.total)),1),e[27]||(e[27]=u(" of ")),o("strong",null,d(t.pagination.total.toLocaleString()),1),e[28]||(e[28]=u(" records ")),t.pagination.last_page>1?(p(),g("span",ae," (Page "+d(t.currentPage)+" of "+d(t.pagination.last_page)+") ",1)):w("",!0)])):(p(),g("span",oe,"No records found"))]),t.pagination.last_page>1?(p(),g("div",ne,[l(U,{modelValue:t.currentPage,"onUpdate:modelValue":[e[8]||(e[8]=a=>t.currentPage=a),i.loadTags],length:t.pagination.last_page,"total-visible":7,density:"comfortable"},null,8,["modelValue","length","onUpdate:modelValue"])])):w("",!0)])]),_:1})]),_:1}),l(I,{modelValue:s.showDialog,"onUpdate:modelValue":e[13]||(e[13]=a=>s.showDialog=a),"max-width":"700",scrollable:"",persistent:""},{default:n(()=>[l(k,null,{default:n(()=>[l(S,{class:"d-flex align-center justify-space-between bg-primary text-white pa-4"},{default:n(()=>[o("span",se,d(s.editingTag?"Edit Tag":"Create New Tag"),1),l(f,{icon:"mdi-close",variant:"text",color:"white",onClick:i.closeDialog},null,8,["onClick"])]),_:1}),l(V,{class:"pa-6"},{default:n(()=>[l(N,{ref:"formRef"},{default:n(()=>[l(P,null,{default:n(()=>[l(h,{cols:"12"},{default:n(()=>[l(b,{modelValue:s.form.name,"onUpdate:modelValue":e[9]||(e[9]=a=>s.form.name=a),label:"Tag Name *",variant:"outlined",rules:[a=>!!a||"Name is required"],hint:"Enter the tag name"},null,8,["modelValue","rules"])]),_:1}),l(h,{cols:"12",md:"6"},{default:n(()=>[l(b,{modelValue:s.form.slug,"onUpdate:modelValue":e[10]||(e[10]=a=>s.form.slug=a),label:"Slug",variant:"outlined",hint:"URL-friendly version (auto-generated if empty)",rules:[a=>!a||/^[a-z0-9-]+$/.test(a)||"Slug can only contain lowercase letters, numbers, and hyphens"]},{append:n(()=>[l(f,{icon:"mdi-refresh",size:"small",variant:"text",onClick:i.generateSlug},null,8,["onClick"])]),_:1},8,["modelValue","rules"])]),_:1}),l(h,{cols:"12",md:"6"},{default:n(()=>[l(T,{modelValue:s.form.type,"onUpdate:modelValue":e[11]||(e[11]=a=>s.form.type=a),items:s.typeOptions,label:"Type *",variant:"outlined",rules:[a=>!!a||"Type is required"],hint:"Select the type of content this tag applies to"},null,8,["modelValue","items","rules"])]),_:1}),l(h,{cols:"12"},{default:n(()=>[l(E,{modelValue:s.form.description,"onUpdate:modelValue":e[12]||(e[12]=a=>s.form.description=a),label:"Description",variant:"outlined",rows:"3",hint:"Brief description of the tag (optional)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(A,{class:"pa-4 bg-grey-lighten-4"},{default:n(()=>[l(z),l(f,{variant:"text",onClick:i.closeDialog},{default:n(()=>e[29]||(e[29]=[u("Cancel")])),_:1,__:[29]},8,["onClick"]),l(f,{color:"primary",variant:"flat",onClick:i.saveTag,loading:s.saving},{default:n(()=>[u(d(s.editingTag?"Update":"Create")+" Tag ",1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ue=H(M,[["render",ie],["__scopeId","data-v-36f39163"]]);export{ue as default};
