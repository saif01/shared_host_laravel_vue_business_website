import{_ as N,c as b,a as t,w as r,e as n,g as l,h as c,r as o,m as w,b as p,i as E,t as g,u as z,f as T,o as i}from"./app-DjJ9iHSO.js";import{h as j}from"./moment-C5S46NFB.js";const F={data(){return{drawer:!0,currentUser:null,userRoles:[],userPermissions:[],currentDate:j().format("Do MMMM YYYY"),currentYear:new Date().getFullYear()}},methods:{async loadUser(){var d;try{const e=localStorage.getItem("admin_token");if(!e){this.$router.push("/admin/login");return}const _=await T.get("/api/v1/auth/user",{headers:{Authorization:`Bearer ${e}`}});this.currentUser=_.data,this.userRoles=_.data.roles||[],this.userPermissions=[],this.userRoles&&this.userRoles.length>0&&this.userRoles.forEach(v=>{v.permissions&&v.permissions.length>0&&v.permissions.forEach(s=>{this.userPermissions.includes(s.slug)||this.userPermissions.push(s.slug)})})}catch(e){console.error("Error loading user:",e),((d=e.response)==null?void 0:d.status)===401&&(localStorage.removeItem("admin_token"),this.$router.push("/admin/login"))}},async logout(){await z().logout(),this.currentUser=null,this.userRoles=[],this.userPermissions=[],this.$router.push("/admin/login")},hasPermission(d){return this.currentUser&&(this.currentUser.role==="admin"||this.userRoles&&this.userRoles.some(e=>e.slug==="administrator"))?!0:this.userPermissions.includes(d)}},mounted(){localStorage.getItem("admin_token")?this.loadUser():this.$router.push("/admin/login")}},q={class:"pa-2"},G={key:1,class:"d-flex align-center mr-4"},H={class:"footer-content"},J={class:"footer-info"},K={class:"copyright-text"};function O(d,e,_,v,s,m){const a=o("v-list-item"),U=o("v-divider"),x=o("v-list-group"),h=o("v-list"),R=o("v-icon"),A=o("v-btn"),S=o("v-navigation-drawer"),L=o("v-app-bar-nav-icon"),f=o("v-chip"),k=o("v-spacer"),P=o("v-img"),D=o("v-avatar"),y=o("v-list-item-title"),B=o("v-menu"),C=o("v-app-bar"),V=o("router-view"),Y=o("v-container"),I=o("v-main"),M=o("v-footer");return i(),b("div",null,[t(S,{modelValue:s.drawer,"onUpdate:modelValue":e[1]||(e[1]=u=>s.drawer=u),class:"gradient_color",location:"left",permanent:"","hide-overlay":"",app:"",dark:""},{append:r(()=>[n("div",q,[t(A,{link:"",router:"",onClick:e[0]||(e[0]=u=>m.logout()),class:"logout-btn text-black",size:"small",block:""},{default:r(()=>[t(R,{left:""},{default:r(()=>e[4]||(e[4]=[p("mdi-logout")])),_:1,__:[4]}),e[5]||(e[5]=p("Logout "))]),_:1,__:[5]})])]),default:r(()=>[e[6]||(e[6]=n("div",{class:"sidebar-shapes"},[n("div",{class:"shape shape-1"}),n("div",{class:"shape shape-2"}),n("div",{class:"shape shape-3"})],-1)),s.currentUser?(i(),l(a,{key:0,class:"user-profile-header","prepend-avatar":s.currentUser.avatar||"/assets/logo/logo.png",title:s.currentUser.name||"Admin Panel",subtitle:s.userRoles&&s.userRoles.length>0?s.userRoles.map(u=>u.name).join(", "):"No roles assigned"},null,8,["prepend-avatar","title","subtitle"])):c("",!0),t(U,{class:"my-0 divider-glow"}),t(h,{density:"compact",nav:""},{default:r(()=>[m.hasPermission("access-dashboard")?(i(),l(a,{key:0,link:"",router:"","prepend-icon":"mdi-view-dashboard",title:"Dashboard",to:{name:"AdminDashboard"},value:"Dashboard",exact:""})):c("",!0),m.hasPermission("manage-pages")?(i(),l(a,{key:1,link:"",router:"","prepend-icon":"mdi-file-document",title:"Pages",to:{name:"AdminPages"},value:"Pages",exact:""})):c("",!0),m.hasPermission("manage-services")?(i(),l(a,{key:2,link:"",router:"","prepend-icon":"mdi-wrench",title:"Services",to:{name:"AdminServices"},value:"Services",exact:""})):c("",!0),m.hasPermission("manage-products")?(i(),l(a,{key:3,link:"",router:"","prepend-icon":"mdi-package-variant",title:"Products",to:{name:"AdminProducts"},value:"Products",exact:""})):c("",!0),m.hasPermission("view-leads")?(i(),l(a,{key:4,link:"",router:"","prepend-icon":"mdi-email",title:"Leads",to:{name:"AdminLeads"},value:"Leads",exact:""})):c("",!0),m.hasPermission("manage-users")?(i(),l(a,{key:5,link:"",router:"","prepend-icon":"mdi-account-group",title:"Users",to:{name:"AdminUsers"},value:"Users",exact:""})):c("",!0),m.hasPermission("manage-roles")?(i(),l(x,{key:6,value:"roles","prepend-icon":"mdi-shield-account","no-action":""},{activator:r(({props:u})=>[t(a,w(u,{title:"Roles & Permissions"}),null,16)]),default:r(()=>[t(a,{"prepend-icon":"mdi-shield-account",title:"Roles",to:{name:"AdminRoles"}}),t(a,{"prepend-icon":"mdi-key",title:"Permissions",to:{name:"AdminPermissions"}})]),_:1})):c("",!0),m.hasPermission("manage-settings")?(i(),l(a,{key:7,link:"",router:"","prepend-icon":"mdi-cog",title:"Settings",to:{name:"AdminSettings"},value:"Settings",exact:""})):c("",!0),m.hasPermission("view-login-logs")?(i(),l(a,{key:8,link:"",router:"","prepend-icon":"mdi-login",title:"Login Logs",to:{name:"AdminLoginLogs"},value:"LoginLogs",exact:""})):c("",!0)]),_:1})]),_:1,__:[6]},8,["modelValue"]),t(C,{app:"",flat:"",density:"compact",class:"gradient_color app-bar-modern"},{default:r(()=>[t(L,{onClick:e[2]||(e[2]=E(u=>s.drawer=!s.drawer,["stop"]))}),t(f,{class:"mx-2 date-chip"},{default:r(()=>[p(g(s.currentDate),1)]),_:1}),t(k),s.currentUser&&(s.currentUser.role==="admin"||s.userRoles&&s.userRoles.some(u=>u.slug==="administrator"))?(i(),l(f,{key:0,"prepend-icon":"mdi-shield-account"},{default:r(()=>e[7]||(e[7]=[p("Administrator")])),_:1,__:[7]})):c("",!0),t(k),s.currentUser?(i(),b("div",G,[t(B,{"open-on-hover":""},{activator:r(({props:u})=>[t(D,w(u,{size:"42",class:"fill-image mr-2",title:s.currentUser.name}),{default:r(()=>[s.currentUser.avatar?(i(),l(P,{key:0,cover:"",src:s.currentUser.avatar,alt:s.currentUser.name},null,8,["src","alt"])):(i(),l(P,{key:1,cover:"",src:"/assets/logo/logo.png",alt:"image"}))]),_:2},1040,["title"])]),default:r(()=>[t(h,null,{default:r(()=>[t(a,null,{default:r(()=>[t(y,null,{default:r(()=>[p(g(s.currentUser.name),1)]),_:1})]),_:1}),t(a,{link:"",router:"",onClick:e[3]||(e[3]=u=>m.logout())},{default:r(()=>[t(y,null,{default:r(()=>e[8]||(e[8]=[p("Logout")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1})])):c("",!0)]),_:1}),t(I,null,{default:r(()=>[t(Y,{fluid:""},{default:r(()=>[t(V)]),_:1})]),_:1}),t(M,{class:"footer-modern gradient_color rtl-footer",app:""},{default:r(()=>[n("div",H,[e[10]||(e[10]=n("div",{class:"footer-brand"},[n("div",{class:"logo-wrapper"},[n("img",{src:"/assets/logo/logo.png",alt:"cpb-it",height:"24",class:"footer-logo"})]),n("div",{class:"brand-text"},[n("span",{class:"brand-name"},"Powered By CPB-IT")])],-1)),e[11]||(e[11]=n("div",{class:"footer-divider"},null,-1)),n("div",J,[e[9]||(e[9]=n("span",{class:"version-badge"},"v2.0",-1)),n("span",K,"Â© "+g(s.currentYear)+" All Rights Reserved",1)])])]),_:1})])}const X=N(F,[["render",O],["__scopeId","data-v-968e7ab9"]]);export{X as default};
