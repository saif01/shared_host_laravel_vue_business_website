import{_ as F,c as g,e as l,a,w as o,b as r,r as i,g as x,h as V,F as U,d as N,f as S,o as p,t as c}from"./app-XbwVsOQu.js";import{a as z}from"./adminPaginationMixin-DN7Wb3ng.js";const A={mixins:[z],data(){return{leads:[],statusFilter:null,typeFilter:null,statusOptions:[{title:"New",value:"new"},{title:"Contacted",value:"contacted"},{title:"Qualified",value:"qualified"},{title:"Converted",value:"converted"},{title:"Lost",value:"lost"}],typeOptions:[{title:"Contact",value:"contact"},{title:"Quote",value:"quote"},{title:"Support",value:"support"}]}},async mounted(){await this.loadLeads()},methods:{async loadLeads(){try{this.loading=!0;const t=this.buildPaginationParams();this.search&&(t.search=this.search),this.statusFilter&&(t.status=this.statusFilter),this.typeFilter&&(t.type=this.typeFilter);const e=await S.get("/api/v1/leads",{params:t,headers:this.getAuthHeaders()});this.leads=e.data.data||[],this.updatePagination(e.data)}catch(t){this.handleApiError(t,"Failed to load leads")}finally{this.loading=!1}},viewLead(t){alert(`Lead Details:
Name: ${t.name}
Email: ${t.email}
Phone: ${t.phone||"N/A"}
Type: ${t.type}
Status: ${t.status}
Message: ${t.message||"N/A"}`)},async exportLeads(){try{const t=await S.get("/api/v1/leads/export/csv",{headers:this.getAuthHeaders(),responseType:"blob"}),e=window.URL.createObjectURL(new Blob([t.data])),u=document.createElement("a");u.href=e,u.setAttribute("download","leads.csv"),document.body.appendChild(u),u.click(),document.body.removeChild(u),this.showSuccess("Leads exported successfully")}catch(t){this.handleApiError(t,"Error exporting leads")}},getStatusColor(t){return{new:"info",contacted:"warning",qualified:"primary",converted:"success",lost:"error"}[t]||"grey"},onPerPageChange(){this.resetPagination(),this.loadLeads()},onSort(t){this.handleSort(t),this.loadLeads()}}},E={class:"d-flex justify-space-between align-center mb-6"},I={class:"d-flex align-center"},O={class:"d-flex align-center"},B={class:"d-flex align-center"},T={class:"d-flex align-center"},D={class:"d-flex align-center"},q={class:"d-flex align-center"},M={key:0};function j(t,e,u,H,d,s){const y=i("v-btn"),f=i("v-select"),v=i("v-col"),C=i("v-text-field"),L=i("v-row"),b=i("v-card-text"),h=i("v-card"),w=i("v-card-title"),m=i("v-icon"),_=i("v-chip"),k=i("v-table"),P=i("v-pagination");return p(),g("div",null,[l("div",E,[e[12]||(e[12]=l("h1",{class:"text-h4"},"Leads Management",-1)),a(y,{color:"primary","prepend-icon":"mdi-download",onClick:s.exportLeads},{default:o(()=>e[11]||(e[11]=[r("Export to CSV")])),_:1,__:[11]},8,["onClick"])]),a(h,{class:"mb-4"},{default:o(()=>[a(b,null,{default:o(()=>[a(L,null,{default:o(()=>[a(v,{cols:"12",md:"3"},{default:o(()=>[a(f,{modelValue:t.perPage,"onUpdate:modelValue":[e[0]||(e[0]=n=>t.perPage=n),s.onPerPageChange],items:t.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),a(v,{cols:"12",md:"3"},{default:o(()=>[a(f,{modelValue:d.statusFilter,"onUpdate:modelValue":[e[1]||(e[1]=n=>d.statusFilter=n),s.loadLeads],items:d.statusOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),a(v,{cols:"12",md:"3"},{default:o(()=>[a(f,{modelValue:d.typeFilter,"onUpdate:modelValue":[e[2]||(e[2]=n=>d.typeFilter=n),s.loadLeads],items:d.typeOptions,label:"Filter by Type","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),a(v,{cols:"12",md:"3"},{default:o(()=>[a(C,{modelValue:t.search,"onUpdate:modelValue":[e[3]||(e[3]=n=>t.search=n),s.loadLeads],label:"Search leads","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(h,null,{default:o(()=>[a(w,null,{default:o(()=>e[13]||(e[13]=[r("Leads")])),_:1,__:[13]}),a(b,null,{default:o(()=>[a(k,null,{default:o(()=>[l("thead",null,[l("tr",null,[l("th",{class:"sortable",onClick:e[4]||(e[4]=n=>s.onSort("name"))},[l("div",I,[e[14]||(e[14]=r(" Name ")),a(m,{icon:t.getSortIcon("name"),size:"small",class:"ml-1"},null,8,["icon"])])]),l("th",{class:"sortable",onClick:e[5]||(e[5]=n=>s.onSort("email"))},[l("div",O,[e[15]||(e[15]=r(" Email ")),a(m,{icon:t.getSortIcon("email"),size:"small",class:"ml-1"},null,8,["icon"])])]),l("th",{class:"sortable",onClick:e[6]||(e[6]=n=>s.onSort("phone"))},[l("div",B,[e[16]||(e[16]=r(" Phone ")),a(m,{icon:t.getSortIcon("phone"),size:"small",class:"ml-1"},null,8,["icon"])])]),l("th",{class:"sortable",onClick:e[7]||(e[7]=n=>s.onSort("type"))},[l("div",T,[e[17]||(e[17]=r(" Type ")),a(m,{icon:t.getSortIcon("type"),size:"small",class:"ml-1"},null,8,["icon"])])]),l("th",{class:"sortable",onClick:e[8]||(e[8]=n=>s.onSort("status"))},[l("div",D,[e[18]||(e[18]=r(" Status ")),a(m,{icon:t.getSortIcon("status"),size:"small",class:"ml-1"},null,8,["icon"])])]),l("th",{class:"sortable",onClick:e[9]||(e[9]=n=>s.onSort("created_at"))},[l("div",q,[e[19]||(e[19]=r(" Date ")),a(m,{icon:t.getSortIcon("created_at"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[20]||(e[20]=l("th",null,"Actions",-1))])]),l("tbody",null,[(p(!0),g(U,null,N(d.leads,n=>(p(),g("tr",{key:n.id},[l("td",null,c(n.name),1),l("td",null,c(n.email),1),l("td",null,c(n.phone||"-"),1),l("td",null,[a(_,{size:"small",variant:"outlined"},{default:o(()=>[r(c(n.type),1)]),_:2},1024)]),l("td",null,[a(_,{color:s.getStatusColor(n.status),size:"small"},{default:o(()=>[r(c(n.status),1)]),_:2},1032,["color"])]),l("td",null,c(t.formatDate(n.created_at)),1),l("td",null,[a(y,{size:"small",icon:"mdi-eye",onClick:Q=>s.viewLead(n),variant:"text"},null,8,["onClick"])])]))),128)),d.leads.length===0?(p(),g("tr",M,e[21]||(e[21]=[l("td",{colspan:"7",class:"text-center py-4"},"No leads found",-1)]))):V("",!0)])]),_:1}),t.pagination.last_page>1?(p(),x(P,{key:0,modelValue:t.currentPage,"onUpdate:modelValue":[e[10]||(e[10]=n=>t.currentPage=n),s.loadLeads],length:t.pagination.last_page,class:"mt-4"},null,8,["modelValue","length","onUpdate:modelValue"])):V("",!0)]),_:1})]),_:1})])}const J=F(A,[["render",j]]);export{J as default};
