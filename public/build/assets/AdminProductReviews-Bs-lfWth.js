import{h as O}from"./moment-C5S46NFB.js";import{a as B}from"./adminPaginationMixin-DN7Wb3ng.js";import{_ as Y,d as _,a as s,b as t,w as l,r,f as a,g as m,t as d,c as g,F as I,e as H,o as u,m as q}from"./app-DFUhJa7k.js";const G={name:"AdminProductReviews",mixins:[B],data(){return{reviews:[],selectedReview:null,reviewToDelete:null,showDetailsDialog:!1,showDeleteDialog:!1,processing:!1,statusFilter:null,ratingFilter:null,statusOptions:[{title:"Pending",value:"pending"},{title:"Approved",value:"approved"},{title:"Rejected",value:"rejected"}],ratingOptions:[{title:"5 Stars",value:5},{title:"4 Stars & Above",value:4},{title:"3 Stars & Above",value:3},{title:"2 Stars & Above",value:2},{title:"1 Star & Above",value:1}]}},async mounted(){await this.loadReviews()},methods:{async loadReviews(){try{this.loading=!0;const i=this.buildPaginationParams();this.search&&(i.search=this.search),this.statusFilter&&(i.status=this.statusFilter),this.ratingFilter&&(i.rating=this.ratingFilter);const e=await this.$axios.get("/api/v1/products/reviews/all",{params:i});this.reviews=e.data.data||[],this.updatePagination(e.data)}catch(i){this.handleApiError(i,"Failed to load reviews")}finally{this.loading=!1}},onSearchChange(i){this.search=i,this.resetPagination(),this.searchDebounceTimer&&clearTimeout(this.searchDebounceTimer),this.searchDebounceTimer=setTimeout(()=>{this.loadReviews()},350)},viewReview(i){this.selectedReview=i,this.showDetailsDialog=!0},async approveReview(i){try{this.processing=!0,await this.$axios.put(`/api/v1/products/${i.product_id}/reviews/${i.id}/approve`),this.$toast.success("Review approved successfully"),this.showDetailsDialog=!1,await this.loadReviews()}catch(e){this.handleApiError(e,"Failed to approve review")}finally{this.processing=!1}},async rejectReview(i){try{this.processing=!0,await this.$axios.put(`/api/v1/products/${i.product_id}/reviews/${i.id}/reject`),this.$toast.success("Review rejected successfully"),this.showDetailsDialog=!1,await this.loadReviews()}catch(e){this.handleApiError(e,"Failed to reject review")}finally{this.processing=!1}},confirmDelete(i){this.reviewToDelete=i,this.showDeleteDialog=!0},async deleteReview(){if(this.reviewToDelete)try{this.processing=!0,await this.$axios.delete(`/api/v1/products/${this.reviewToDelete.product_id}/reviews/${this.reviewToDelete.id}`),this.$toast.success("Review deleted successfully"),this.showDeleteDialog=!1,this.showDetailsDialog=!1,await this.loadReviews()}catch(i){this.handleApiError(i,"Failed to delete review")}finally{this.processing=!1,this.reviewToDelete=null}},getStatusColor(i){return{pending:"warning",approved:"success",rejected:"error"}[i]||"grey"},getStatusLabel(i){return{pending:"Pending",approved:"Approved",rejected:"Rejected"}[i]||i},formatDate(i){return O(i).format("MMM DD, YYYY h:mm A")}}},J={class:"text-caption text-grey"},K={key:0},Q={key:0},W={class:"text-body-2 font-weight-bold"},X={class:"text-caption text-grey"},Z={class:"d-flex align-center"},$={class:"text-body-2"},ee={class:"text-caption"},te={style:{"max-width":"300px"}},le={key:0,class:"text-body-2 font-weight-bold"},se={key:1,class:"text-caption text-grey text-truncate"},ie={key:2,class:"text-caption mt-1"},oe={class:"text-caption"},ne={class:"text-center"},ae={key:1},re={colspan:"7",class:"text-center pa-8"},de={key:2},ue={colspan:"7",class:"text-center pa-8"},ce={class:"text-body-1"},me={class:"text-body-1"},ve={class:"text-body-2 mt-1"},pe={class:"text-body-1"},_e={class:"text-body-1"},ge={class:"text-body-1"},fe={class:"text-body-1"};function we(i,e,be,he,n,c){const x=r("v-select"),v=r("v-col"),j=r("v-text-field"),V=r("v-row"),b=r("v-card-text"),h=r("v-card"),k=r("v-card-title"),p=r("v-icon"),T=r("v-avatar"),y=r("v-chip"),C=r("v-rating"),f=r("v-btn"),R=r("v-list-item-title"),D=r("v-list-item"),z=r("v-divider"),U=r("v-list"),N=r("v-menu"),M=r("v-progress-circular"),E=r("v-table"),L=r("v-pagination"),P=r("v-spacer"),A=r("v-card-actions"),S=r("v-dialog");return u(),_("div",null,[e[48]||(e[48]=s("div",{class:"page-header"},[s("h1",{class:"text-h4 page-title"},"Product Reviews Management")],-1)),t(h,{class:"mb-4"},{default:l(()=>[t(b,null,{default:l(()=>[t(V,null,{default:l(()=>[t(v,{cols:"12",md:"3"},{default:l(()=>[t(x,{modelValue:i.perPage,"onUpdate:modelValue":[e[0]||(e[0]=o=>i.perPage=o),i.onPerPageChange],items:i.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),t(v,{cols:"12",md:"3"},{default:l(()=>[t(x,{modelValue:n.statusFilter,"onUpdate:modelValue":[e[1]||(e[1]=o=>n.statusFilter=o),c.loadReviews],items:n.statusOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),t(v,{cols:"12",md:"3"},{default:l(()=>[t(x,{modelValue:n.ratingFilter,"onUpdate:modelValue":[e[2]||(e[2]=o=>n.ratingFilter=o),c.loadReviews],items:n.ratingOptions,label:"Filter by Rating","prepend-inner-icon":"mdi-star",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),t(v,{cols:"12",md:"3"},{default:l(()=>[t(j,{modelValue:i.search,"onUpdate:modelValue":[e[3]||(e[3]=o=>i.search=o),c.onSearchChange],label:"Search","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(k,{class:"d-flex justify-space-between align-center"},{default:l(()=>[s("span",J,[e[12]||(e[12]=a(" Total Records: ")),s("strong",null,d(i.pagination.total||0),1),n.reviews.length>0?(u(),_("span",K," | Showing "+d((i.currentPage-1)*i.perPage+1)+" to "+d(Math.min(i.currentPage*i.perPage,i.pagination.total))+" of "+d(i.pagination.total),1)):m("",!0)])]),_:1}),t(b,null,{default:l(()=>[t(E,null,{default:l(()=>[e[25]||(e[25]=s("thead",null,[s("tr",null,[s("th",null,"Product"),s("th",null,"Reviewer"),s("th",null,"Rating"),s("th",null,"Comment"),s("th",null,"Status"),s("th",null,"Date"),s("th",{class:"text-center"},"Actions")])],-1)),!i.loading&&n.reviews.length>0?(u(),_("tbody",Q,[(u(!0),_(I,null,H(n.reviews,o=>{var F;return u(),_("tr",{key:o.id},[s("td",null,[s("div",W,d(((F=o.product)==null?void 0:F.title)||"N/A"),1),s("div",X,"#"+d(o.product_id),1)]),s("td",null,[s("div",Z,[t(T,{size:"32",class:"mr-2"},{default:l(()=>[t(p,null,{default:l(()=>e[13]||(e[13]=[a("mdi-account-circle")])),_:1,__:[13]})]),_:1}),s("div",null,[s("div",$,d(o.reviewer_display_name||"Anonymous"),1),o.verified_purchase?(u(),g(y,{key:0,size:"x-small",color:"success",variant:"flat"},{default:l(()=>[t(p,{size:"x-small",class:"mr-1"},{default:l(()=>e[14]||(e[14]=[a("mdi-check-decagram")])),_:1,__:[14]}),e[15]||(e[15]=a(" Verified "))]),_:1,__:[15]})):m("",!0)])])]),s("td",null,[t(C,{"model-value":o.rating,readonly:"",length:5,size:16,"active-color":"amber",color:"grey-lighten-1",density:"compact","half-increments":""},null,8,["model-value"]),s("div",ee,d(o.rating)+" / 5.0",1)]),s("td",te,[o.title?(u(),_("div",le,d(o.title),1)):m("",!0),o.comment?(u(),_("div",se,d(o.comment),1)):m("",!0),o.helpful_count>0?(u(),_("div",ie,[t(p,{size:"small",color:"success"},{default:l(()=>e[16]||(e[16]=[a("mdi-thumb-up")])),_:1,__:[16]}),a(" "+d(o.helpful_count)+" ",1),t(p,{size:"small",color:"error",class:"ml-2"},{default:l(()=>e[17]||(e[17]=[a("mdi-thumb-down")])),_:1,__:[17]}),a(" "+d(o.not_helpful_count),1)])):m("",!0)]),s("td",null,[t(y,{color:c.getStatusColor(o.status),size:"small",variant:"flat"},{default:l(()=>[a(d(c.getStatusLabel(o.status)),1)]),_:2},1032,["color"])]),s("td",null,[s("div",oe,d(c.formatDate(o.created_at)),1)]),s("td",ne,[t(N,null,{activator:l(({props:w})=>[t(f,q({ref_for:!0},w,{icon:"mdi-dots-vertical",size:"small",variant:"text"}),null,16)]),default:l(()=>[t(U,{density:"compact"},{default:l(()=>[t(D,{onClick:w=>c.viewReview(o),"prepend-icon":"mdi-eye"},{default:l(()=>[t(R,null,{default:l(()=>e[18]||(e[18]=[a("View Details")])),_:1,__:[18]})]),_:2},1032,["onClick"]),o.status!=="approved"?(u(),g(D,{key:0,onClick:w=>c.approveReview(o),"prepend-icon":"mdi-check-circle",disabled:n.processing},{default:l(()=>[t(R,null,{default:l(()=>e[19]||(e[19]=[a("Approve")])),_:1,__:[19]})]),_:2},1032,["onClick","disabled"])):m("",!0),o.status!=="rejected"?(u(),g(D,{key:1,onClick:w=>c.rejectReview(o),"prepend-icon":"mdi-close-circle",disabled:n.processing},{default:l(()=>[t(R,null,{default:l(()=>e[20]||(e[20]=[a("Reject")])),_:1,__:[20]})]),_:2},1032,["onClick","disabled"])):m("",!0),t(z),t(D,{onClick:w=>c.confirmDelete(o),"prepend-icon":"mdi-delete",disabled:n.processing},{default:l(()=>[t(R,{class:"text-error"},{default:l(()=>e[21]||(e[21]=[a("Delete")])),_:1,__:[21]})]),_:2},1032,["onClick","disabled"])]),_:2},1024)]),_:2},1024)])])}),128))])):!i.loading&&n.reviews.length===0?(u(),_("tbody",ae,[s("tr",null,[s("td",re,[t(p,{size:"64",color:"grey-lighten-1"},{default:l(()=>e[22]||(e[22]=[a("mdi-star-off")])),_:1,__:[22]}),e[23]||(e[23]=s("p",{class:"text-h6 text-grey mt-4"},"No reviews found",-1))])])])):(u(),_("tbody",de,[s("tr",null,[s("td",ue,[t(M,{indeterminate:"",color:"primary"}),e[24]||(e[24]=s("p",{class:"text-grey mt-4"},"Loading reviews...",-1))])])]))]),_:1,__:[25]}),i.pagination.last_page>1?(u(),g(L,{key:0,modelValue:i.currentPage,"onUpdate:modelValue":[e[4]||(e[4]=o=>i.currentPage=o),c.loadReviews],length:i.pagination.last_page,"total-visible":7,class:"mt-4"},null,8,["modelValue","length","onUpdate:modelValue"])):m("",!0)]),_:1})]),_:1}),t(S,{modelValue:n.showDetailsDialog,"onUpdate:modelValue":e[9]||(e[9]=o=>n.showDetailsDialog=o),"max-width":"700",scrollable:""},{default:l(()=>[n.selectedReview?(u(),g(h,{key:0},{default:l(()=>[t(k,{class:"d-flex align-center justify-space-between bg-primary text-white pa-4"},{default:l(()=>[e[26]||(e[26]=s("span",{class:"text-h5 font-weight-bold"},"Review Details",-1)),t(f,{icon:"mdi-close",variant:"text",color:"white",onClick:e[5]||(e[5]=o=>n.showDetailsDialog=!1)})]),_:1,__:[26]}),t(b,{class:"pa-6"},{default:l(()=>[t(V,null,{default:l(()=>[t(v,{cols:"12"},{default:l(()=>{var o;return[e[27]||(e[27]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Product",-1)),s("div",ce,d(((o=n.selectedReview.product)==null?void 0:o.title)||"N/A"),1)]}),_:1,__:[27]}),t(v,{cols:"12",md:"6"},{default:l(()=>[e[30]||(e[30]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Reviewer",-1)),s("div",me,d(n.selectedReview.reviewer_display_name||"Anonymous"),1),n.selectedReview.verified_purchase?(u(),g(y,{key:0,size:"small",color:"success",class:"mt-1"},{default:l(()=>[t(p,{size:"small",class:"mr-1"},{default:l(()=>e[28]||(e[28]=[a("mdi-check-decagram")])),_:1,__:[28]}),e[29]||(e[29]=a(" Verified Purchase "))]),_:1,__:[29]})):m("",!0)]),_:1,__:[30]}),t(v,{cols:"12",md:"6"},{default:l(()=>[e[31]||(e[31]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Rating",-1)),t(C,{"model-value":n.selectedReview.rating,readonly:"",length:5,size:24,"active-color":"amber",color:"grey-lighten-1","half-increments":""},null,8,["model-value"]),s("div",ve,d(n.selectedReview.rating)+" / 5.0",1)]),_:1,__:[31]}),n.selectedReview.title?(u(),g(v,{key:0,cols:"12"},{default:l(()=>[e[32]||(e[32]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Title",-1)),s("div",pe,d(n.selectedReview.title),1)]),_:1,__:[32]})):m("",!0),n.selectedReview.comment?(u(),g(v,{key:1,cols:"12"},{default:l(()=>[e[33]||(e[33]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Comment",-1)),s("div",_e,d(n.selectedReview.comment),1)]),_:1,__:[33]})):m("",!0),t(v,{cols:"12",md:"4"},{default:l(()=>[e[34]||(e[34]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Status",-1)),t(y,{color:c.getStatusColor(n.selectedReview.status),variant:"flat"},{default:l(()=>[a(d(c.getStatusLabel(n.selectedReview.status)),1)]),_:1},8,["color"])]),_:1,__:[34]}),t(v,{cols:"12",md:"4"},{default:l(()=>[e[37]||(e[37]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Helpful",-1)),s("div",ge,[t(p,{color:"success"},{default:l(()=>e[35]||(e[35]=[a("mdi-thumb-up")])),_:1,__:[35]}),a(" "+d(n.selectedReview.helpful_count)+" ",1),t(p,{color:"error",class:"ml-2"},{default:l(()=>e[36]||(e[36]=[a("mdi-thumb-down")])),_:1,__:[36]}),a(" "+d(n.selectedReview.not_helpful_count),1)])]),_:1,__:[37]}),t(v,{cols:"12",md:"4"},{default:l(()=>[e[38]||(e[38]=s("div",{class:"text-subtitle-1 font-weight-bold mb-2"},"Submitted",-1)),s("div",fe,d(c.formatDate(n.selectedReview.created_at)),1)]),_:1,__:[38]})]),_:1})]),_:1}),t(A,{class:"pa-4 bg-grey-lighten-4"},{default:l(()=>[t(P),n.selectedReview.status!=="approved"?(u(),g(f,{key:0,color:"success",variant:"flat",onClick:e[6]||(e[6]=o=>c.approveReview(n.selectedReview)),loading:n.processing},{default:l(()=>[t(p,{class:"mr-2"},{default:l(()=>e[39]||(e[39]=[a("mdi-check-circle")])),_:1,__:[39]}),e[40]||(e[40]=a(" Approve "))]),_:1,__:[40]},8,["loading"])):m("",!0),n.selectedReview.status!=="rejected"?(u(),g(f,{key:1,color:"error",variant:"flat",onClick:e[7]||(e[7]=o=>c.rejectReview(n.selectedReview)),loading:n.processing},{default:l(()=>[t(p,{class:"mr-2"},{default:l(()=>e[41]||(e[41]=[a("mdi-close-circle")])),_:1,__:[41]}),e[42]||(e[42]=a(" Reject "))]),_:1,__:[42]},8,["loading"])):m("",!0),t(f,{variant:"text",onClick:e[8]||(e[8]=o=>n.showDetailsDialog=!1)},{default:l(()=>e[43]||(e[43]=[a("Close")])),_:1,__:[43]})]),_:1})]),_:1})):m("",!0)]),_:1},8,["modelValue"]),t(S,{modelValue:n.showDeleteDialog,"onUpdate:modelValue":e[11]||(e[11]=o=>n.showDeleteDialog=o),"max-width":"400"},{default:l(()=>[t(h,null,{default:l(()=>[t(k,{class:"text-h6"},{default:l(()=>e[44]||(e[44]=[a("Confirm Delete")])),_:1,__:[44]}),t(b,null,{default:l(()=>e[45]||(e[45]=[a(" Are you sure you want to delete this review? This action cannot be undone. ")])),_:1,__:[45]}),t(A,null,{default:l(()=>[t(P),t(f,{variant:"text",onClick:e[10]||(e[10]=o=>n.showDeleteDialog=!1)},{default:l(()=>e[46]||(e[46]=[a("Cancel")])),_:1,__:[46]}),t(f,{color:"error",variant:"flat",onClick:c.deleteReview,loading:n.processing},{default:l(()=>e[47]||(e[47]=[a("Delete")])),_:1,__:[47]},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const xe=Y(G,[["render",we],["__scopeId","data-v-37df9ec7"]]);export{xe as default};
