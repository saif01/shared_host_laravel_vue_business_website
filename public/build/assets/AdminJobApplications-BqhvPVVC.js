import{_ as E,d as m,a as s,b as l,w as o,r as p,f as n,h as v,t as r,F as P,e as N,c as h,g as _,o as d}from"./app-DfM5fqPs.js";import{a as H}from"./adminPaginationMixin-DN7Wb3ng.js";const I={mixins:[H],data(){return{applications:[],showDetailsDialog:!1,selectedApplication:null,notesText:"",savingNotes:!1,statusFilter:null,careerFilter:null,statusOptions:[{title:"New",value:"new"},{title:"Reviewed",value:"reviewed"},{title:"Shortlisted",value:"shortlisted"},{title:"Rejected",value:"rejected"},{title:"Hired",value:"hired"}],careerOptions:[]}},async mounted(){await this.loadApplications(),await this.loadCareers(),this.$route.query.career_id&&(this.careerFilter=parseInt(this.$route.query.career_id),await this.loadApplications())},methods:{async loadApplications(){try{this.loading=!0;const t=this.buildPaginationParams();this.search&&(t.search=this.search),this.statusFilter&&(t.status=this.statusFilter),this.careerFilter&&(t.career_id=this.careerFilter);const e=await _.get("/api/v1/job-applications",{params:t,headers:this.getAuthHeaders()});this.applications=e.data.data||[],this.updatePagination(e.data)}catch(t){this.handleApiError(t,"Failed to load job applications")}finally{this.loading=!1}},async loadCareers(){try{const e=(await _.get("/api/v1/careers",{params:{per_page:1e3},headers:this.getAuthHeaders()})).data.data||[];this.careerOptions=e.map(x=>({title:x.title,value:x.id}))}catch(t){console.error("Failed to load careers:",t)}},async updateStatus(t){try{await _.put(`/api/v1/job-applications/${t.id}`,{status:t.status},{headers:this.getAuthHeaders()}),this.showSuccess("Status updated successfully")}catch(e){this.handleApiError(e,"Failed to update status"),await this.loadApplications()}},viewApplication(t){this.selectedApplication={...t},this.notesText=t.notes||"",this.showDetailsDialog=!0},async saveNotes(){if(this.selectedApplication){this.savingNotes=!0;try{await _.put(`/api/v1/job-applications/${this.selectedApplication.id}`,{notes:this.notesText},{headers:this.getAuthHeaders()}),this.showSuccess("Notes saved successfully"),this.selectedApplication.notes=this.notesText,await this.loadApplications()}catch(t){this.handleApiError(t,"Failed to save notes")}finally{this.savingNotes=!1}}},async deleteApplication(t){if(confirm("Are you sure you want to delete this application?"))try{await _.delete(`/api/v1/job-applications/${t}`,{headers:this.getAuthHeaders()}),this.showSuccess("Application deleted successfully"),await this.loadApplications()}catch(e){this.handleApiError(e,"Error deleting application")}},getStatusColor(t){return{new:"info",reviewed:"primary",shortlisted:"warning",rejected:"error",hired:"success"}[t]||"grey"},onPerPageChange(){this.resetPagination(),this.loadApplications()},onSort(t){this.handleSort(t),this.loadApplications()}}},O={class:"text-caption text-grey"},M={key:0},L={class:"d-flex align-center"},R={class:"d-flex align-center"},B={class:"d-flex align-center"},J={class:"d-flex align-center"},q={class:"d-flex"},W={key:1,class:"text-grey"},G={key:0},K={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},Q={class:"text-caption text-grey"},X={key:0},Y={key:0,class:"ml-2"},Z={key:1},$={key:0,class:"d-flex align-center gap-2"},ee={class:"text-body-1"},te={class:"text-body-1"},le=["href"],se={class:"text-body-1"},oe={class:"text-body-1"},ae={key:1},ie={class:"text-body-1"},ne={class:"text-body-1"},re=["innerHTML"],de={class:"mt-2"},pe={class:"text-body-1"};function ue(t,e,x,ce,a,u){const A=p("v-select"),c=p("v-col"),D=p("v-text-field"),C=p("v-row"),k=p("v-card-text"),V=p("v-card"),F=p("v-card-title"),w=p("v-icon"),f=p("v-skeleton-loader"),S=p("v-chip"),y=p("v-btn"),U=p("v-table"),j=p("v-pagination"),g=p("v-label"),T=p("v-textarea"),z=p("v-dialog");return d(),m("div",null,[e[39]||(e[39]=s("div",{class:"page-header"},[s("h1",{class:"text-h4 page-title"},"Job Applications Management")],-1)),l(V,{class:"mb-4"},{default:o(()=>[l(k,null,{default:o(()=>[l(C,null,{default:o(()=>[l(c,{cols:"12",md:"3"},{default:o(()=>[l(A,{modelValue:t.perPage,"onUpdate:modelValue":[e[0]||(e[0]=i=>t.perPage=i),u.onPerPageChange],items:t.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(c,{cols:"12",md:"3"},{default:o(()=>[l(A,{modelValue:a.statusFilter,"onUpdate:modelValue":[e[1]||(e[1]=i=>a.statusFilter=i),u.loadApplications],items:a.statusOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(c,{cols:"12",md:"3"},{default:o(()=>[l(A,{modelValue:a.careerFilter,"onUpdate:modelValue":[e[2]||(e[2]=i=>a.careerFilter=i),u.loadApplications],items:a.careerOptions,label:"Filter by Career","prepend-inner-icon":"mdi-briefcase",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(c,{cols:"12",md:"3"},{default:o(()=>[l(D,{modelValue:t.search,"onUpdate:modelValue":[e[3]||(e[3]=i=>t.search=i),u.loadApplications],label:"Search applications","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(V,null,{default:o(()=>[l(F,{class:"d-flex justify-space-between align-center"},{default:o(()=>[e[13]||(e[13]=s("span",null,"Job Applications",-1)),s("span",O,[e[12]||(e[12]=n(" Total Records: ")),s("strong",null,r(t.pagination.total||0),1),a.applications.length>0?(d(),m("span",M," | Showing "+r((t.currentPage-1)*t.perPage+1)+" to "+r(Math.min(t.currentPage*t.perPage,t.pagination.total))+" of "+r(t.pagination.total),1)):v("",!0)])]),_:1,__:[13]}),l(k,null,{default:o(()=>[l(U,null,{default:o(()=>[s("thead",null,[s("tr",null,[s("th",{class:"sortable",onClick:e[4]||(e[4]=i=>u.onSort("name"))},[s("div",L,[e[14]||(e[14]=n(" Name ")),l(w,{icon:t.getSortIcon("name"),size:"small",class:"ml-1"},null,8,["icon"])])]),s("th",{class:"sortable",onClick:e[5]||(e[5]=i=>u.onSort("email"))},[s("div",R,[e[15]||(e[15]=n(" Email ")),l(w,{icon:t.getSortIcon("email"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[18]||(e[18]=s("th",null,"Phone",-1)),e[19]||(e[19]=s("th",null,"Career",-1)),s("th",{class:"sortable",onClick:e[6]||(e[6]=i=>u.onSort("status"))},[s("div",B,[e[16]||(e[16]=n(" Status ")),l(w,{icon:t.getSortIcon("status"),size:"small",class:"ml-1"},null,8,["icon"])])]),s("th",{class:"sortable",onClick:e[7]||(e[7]=i=>u.onSort("created_at"))},[s("div",J,[e[17]||(e[17]=n(" Applied Date ")),l(w,{icon:t.getSortIcon("created_at"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[20]||(e[20]=s("th",null,"Actions",-1))])]),s("tbody",null,[t.loading?(d(),m(P,{key:0},N(5,i=>s("tr",{key:`skeleton-${i}`},[s("td",null,[l(f,{type:"text",width:"150"})]),s("td",null,[l(f,{type:"text",width:"200"})]),s("td",null,[l(f,{type:"text",width:"120"})]),s("td",null,[l(f,{type:"text",width:"150"})]),s("td",null,[l(f,{type:"chip",width:"100",height:"24"})]),s("td",null,[l(f,{type:"text",width:"120"})]),s("td",null,[s("div",q,[l(f,{type:"button",width:"32",height:"32",class:"mr-1"}),l(f,{type:"button",width:"32",height:"32"})])])])),64)):(d(),m(P,{key:1},[(d(!0),m(P,null,N(a.applications,i=>(d(),m("tr",{key:i.id},[s("td",null,r(i.name),1),s("td",null,r(i.email),1),s("td",null,r(i.phone||"-"),1),s("td",null,[i.career?(d(),h(S,{key:0,size:"small",variant:"outlined"},{default:o(()=>[n(r(i.career.title),1)]),_:2},1024)):(d(),m("span",W,"-"))]),s("td",null,[l(A,{modelValue:i.status,"onUpdate:modelValue":[b=>i.status=b,b=>u.updateStatus(i)],items:a.statusOptions,variant:"outlined",density:"compact","hide-details":"",style:{minWidth:"140px"}},null,8,["modelValue","onUpdate:modelValue","items"])]),s("td",null,r(t.formatDate(i.created_at)),1),s("td",null,[l(y,{size:"small",icon:"mdi-eye",onClick:b=>u.viewApplication(i),variant:"text",color:"info",title:"View Application"},null,8,["onClick"]),l(y,{size:"small",icon:"mdi-delete",onClick:b=>u.deleteApplication(i.id),variant:"text",color:"error",title:"Delete Application"},null,8,["onClick"])])]))),128)),a.applications.length===0?(d(),m("tr",G,e[21]||(e[21]=[s("td",{colspan:"7",class:"text-center py-4"},"No applications found",-1)]))):v("",!0)],64))])]),_:1}),s("div",K,[s("div",Q,[a.applications.length>0&&t.pagination.total>0?(d(),m("span",X,[e[22]||(e[22]=n(" Showing ")),s("strong",null,r((t.currentPage-1)*t.perPage+1),1),e[23]||(e[23]=n(" to ")),s("strong",null,r(Math.min(t.currentPage*t.perPage,t.pagination.total)),1),e[24]||(e[24]=n(" of ")),s("strong",null,r(t.pagination.total.toLocaleString()),1),e[25]||(e[25]=n(" records ")),t.pagination.last_page>1?(d(),m("span",Y," (Page "+r(t.currentPage)+" of "+r(t.pagination.last_page)+") ",1)):v("",!0)])):(d(),m("span",Z," No records found "))]),t.pagination.last_page>1?(d(),m("div",$,[l(j,{modelValue:t.currentPage,"onUpdate:modelValue":[e[8]||(e[8]=i=>t.currentPage=i),u.loadApplications],length:t.pagination.last_page,"total-visible":7,density:"comfortable"},null,8,["modelValue","length","onUpdate:modelValue"])])):v("",!0)])]),_:1})]),_:1}),l(z,{modelValue:a.showDetailsDialog,"onUpdate:modelValue":e[11]||(e[11]=i=>a.showDetailsDialog=i),"max-width":"800",scrollable:""},{default:o(()=>[a.selectedApplication?(d(),h(V,{key:0},{default:o(()=>[l(F,{class:"d-flex align-center justify-space-between bg-primary text-white pa-4"},{default:o(()=>[e[26]||(e[26]=s("span",{class:"text-h5 font-weight-bold"},"Application Details",-1)),l(y,{icon:"mdi-close",variant:"text",color:"white",onClick:e[9]||(e[9]=i=>a.showDetailsDialog=!1)})]),_:1,__:[26]}),l(k,{class:"pa-6"},{default:o(()=>[l(C,null,{default:o(()=>[l(c,{cols:"12",md:"6"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[27]||(e[27]=[n("Name")])),_:1,__:[27]}),s("p",ee,r(a.selectedApplication.name),1)]),_:1}),l(c,{cols:"12",md:"6"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[28]||(e[28]=[n("Email")])),_:1,__:[28]}),s("p",te,[s("a",{href:`mailto:${a.selectedApplication.email}`},r(a.selectedApplication.email),9,le)])]),_:1}),l(c,{cols:"12",md:"6"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[29]||(e[29]=[n("Phone")])),_:1,__:[29]}),s("p",se,r(a.selectedApplication.phone||"-"),1)]),_:1}),l(c,{cols:"12",md:"6"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[30]||(e[30]=[n("Career Position")])),_:1,__:[30]}),s("p",oe,[a.selectedApplication.career?(d(),h(S,{key:0,size:"small"},{default:o(()=>[n(r(a.selectedApplication.career.title),1)]),_:1})):(d(),m("span",ae,"-"))])]),_:1}),l(c,{cols:"12",md:"6"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[31]||(e[31]=[n("Status")])),_:1,__:[31]}),s("p",ie,[l(S,{color:u.getStatusColor(a.selectedApplication.status),size:"small"},{default:o(()=>[n(r(a.selectedApplication.status),1)]),_:1},8,["color"])])]),_:1}),l(c,{cols:"12",md:"6"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[32]||(e[32]=[n("Applied Date")])),_:1,__:[32]}),s("p",ne,r(t.formatDateTime(a.selectedApplication.created_at)),1)]),_:1}),a.selectedApplication.cover_letter?(d(),h(c,{key:0,cols:"12"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[33]||(e[33]=[n("Cover Letter")])),_:1,__:[33]}),s("div",{class:"text-body-1 mt-2",innerHTML:a.selectedApplication.cover_letter},null,8,re)]),_:1})):v("",!0),a.selectedApplication.resume_url?(d(),h(c,{key:1,cols:"12"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[34]||(e[34]=[n("Resume")])),_:1,__:[34]}),s("div",de,[l(y,{color:"primary",variant:"outlined",href:a.selectedApplication.resume_url,target:"_blank","prepend-icon":"mdi-download"},{default:o(()=>e[35]||(e[35]=[n(" Download Resume ")])),_:1,__:[35]},8,["href"])])]),_:1})):v("",!0),a.selectedApplication.notes?(d(),h(c,{key:2,cols:"12"},{default:o(()=>[l(g,{class:"text-caption text-grey"},{default:o(()=>e[36]||(e[36]=[n("Notes")])),_:1,__:[36]}),s("p",pe,r(a.selectedApplication.notes),1)]),_:1})):v("",!0),l(c,{cols:"12"},{default:o(()=>[l(g,{class:"text-caption text-grey mb-2"},{default:o(()=>e[37]||(e[37]=[n("Add/Edit Notes")])),_:1,__:[37]}),l(T,{modelValue:a.notesText,"onUpdate:modelValue":e[10]||(e[10]=i=>a.notesText=i),variant:"outlined",rows:"3",placeholder:"Add notes about this application..."},null,8,["modelValue"]),l(y,{color:"primary",onClick:u.saveNotes,class:"mt-2",loading:a.savingNotes},{default:o(()=>e[38]||(e[38]=[n(" Save Notes ")])),_:1,__:[38]},8,["onClick","loading"])]),_:1})]),_:1})]),_:1})]),_:1})):v("",!0)]),_:1},8,["modelValue"])])}const fe=E(I,[["render",ue],["__scopeId","data-v-9aef6d2f"]]);export{fe as default};
