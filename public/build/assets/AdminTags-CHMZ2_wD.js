import{_ as A,d as f,a as o,b as l,w as s,f as u,r,h as b,t as d,F as I,e as R,c as B,g as v,o as g}from"./app-aVdZPH9_.js";import{a as H}from"./adminPaginationMixin-DN7Wb3ng.js";const M={mixins:[H],data(){return{tags:[],showDialog:!1,editingTag:null,saving:!1,typeFilter:null,typeOptions:[{title:"Product",value:"product"},{title:"Service",value:"service"},{title:"Post",value:"post"},{title:"General",value:"general"}],form:{name:"",slug:"",type:"product",description:""}}},async mounted(){await this.loadTags()},methods:{async loadTags(){try{this.loading=!0;const t=this.buildPaginationParams();this.search&&(t.search=this.search),this.typeFilter&&(t.type=this.typeFilter);const e=await v.get("/api/v1/tags",{params:t,headers:this.getAuthHeaders()});this.tags=e.data.data||[],this.updatePagination(e.data)}catch(t){this.handleApiError(t,"Failed to load tags")}finally{this.loading=!1}},async openDialog(t=null){if(this.editingTag=t,this.showDialog=!0,t)try{await this.loadTagForEdit(t)}catch(e){console.error("Error loading tag for edit:",e)}else this.resetForm()},async loadTagForEdit(t){var e;try{const p=await v.get(`/api/v1/tags/${t.id}`,{headers:this.getAuthHeaders()}),m=((e=p.data)==null?void 0:e.data)||p.data;if(!m)throw new Error("No tag data received from server");this.form={name:m.name||"",slug:m.slug||"",type:m.type||"product",description:m.description||""}}catch(p){throw this.handleApiError(p,"Failed to load tag"),p}},resetForm(){this.form={name:"",slug:"",type:this.typeFilter||"product",description:""}},generateSlug(){this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""))},async saveTag(){const{valid:t}=await this.$refs.formRef.validate();if(!t){this.showError("Please fill in all required fields");return}try{this.saving=!0;const e={name:this.form.name,type:this.form.type,description:this.form.description||null};this.form.slug&&(e.slug=this.form.slug),this.editingTag?(await v.put(`/api/v1/tags/${this.editingTag.id}`,e,{headers:this.getAuthHeaders()}),this.showSuccess("Tag updated successfully")):(await v.post("/api/v1/tags",e,{headers:this.getAuthHeaders()}),this.showSuccess("Tag created successfully")),this.closeDialog(),await this.loadTags()}catch(e){this.handleApiError(e,"Failed to save tag")}finally{this.saving=!1}},editTag(t){this.openDialog(t)},async deleteTag(t){var e,p,m,n;if(confirm("Are you sure you want to delete this tag? This action cannot be undone."))try{await v.delete(`/api/v1/tags/${t}`,{headers:this.getAuthHeaders()}),this.showSuccess("Tag deleted successfully"),await this.loadTags()}catch(i){const c=((p=(e=i.response)==null?void 0:e.data)==null?void 0:p.error)||((n=(m=i.response)==null?void 0:m.data)==null?void 0:n.message)||"Error deleting tag";this.showError(c)}},closeDialog(){this.showDialog=!1,this.editingTag=null,this.resetForm(),this.$refs.formRef&&this.$refs.formRef.resetValidation()},onPerPageChange(){this.resetPagination(),this.loadTags()},onSort(t){this.handleSort(t),this.loadTags()}}},L={class:"page-header"},O={class:"text-caption text-grey"},j={key:0},q={class:"d-flex align-center"},G={class:"d-flex align-center"},J={class:"d-flex align-center"},K={class:"d-flex align-center"},Q={class:"font-weight-medium"},W={key:0,class:"text-body-2"},X={key:1,class:"text-caption text-grey"},Y={class:"text-caption"},Z={key:0},$={class:"d-flex justify-space-between align-center mt-4"},ee={class:"text-caption text-grey"},te={key:0},le={key:1},ae={class:"text-h5 font-weight-bold"};function oe(t,e,p,m,n,i){const c=r("v-btn"),_=r("v-select"),h=r("v-col"),w=r("v-text-field"),k=r("v-row"),T=r("v-card-text"),V=r("v-card"),C=r("v-card-title"),y=r("v-icon"),P=r("v-chip"),S=r("v-table"),D=r("v-pagination"),F=r("v-textarea"),U=r("v-form"),x=r("v-spacer"),E=r("v-card-actions"),N=r("v-dialog");return g(),f("div",null,[o("div",L,[e[15]||(e[15]=o("h1",{class:"text-h4 page-title"},"Tags Management",-1)),l(c,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=a=>i.openDialog()),class:"add-button"},{default:s(()=>e[14]||(e[14]=[u("Create Tag")])),_:1,__:[14]})]),l(V,{class:"mb-4"},{default:s(()=>[l(T,null,{default:s(()=>[l(k,null,{default:s(()=>[l(h,{cols:"12",md:"3"},{default:s(()=>[l(_,{modelValue:t.perPage,"onUpdate:modelValue":[e[1]||(e[1]=a=>t.perPage=a),i.onPerPageChange],items:t.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(h,{cols:"12",md:"3"},{default:s(()=>[l(_,{modelValue:n.typeFilter,"onUpdate:modelValue":[e[2]||(e[2]=a=>n.typeFilter=a),i.loadTags],items:n.typeOptions,label:"Filter by Type","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(h,{cols:"12",md:"6"},{default:s(()=>[l(w,{modelValue:t.search,"onUpdate:modelValue":[e[3]||(e[3]=a=>t.search=a),i.loadTags],label:"Search tags","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(V,null,{default:s(()=>[l(C,{class:"d-flex justify-space-between align-center"},{default:s(()=>[e[17]||(e[17]=o("span",null,"Tags",-1)),o("span",O,[e[16]||(e[16]=u(" Total Records: ")),o("strong",null,d(t.pagination.total||0),1),n.tags.length>0?(g(),f("span",j," | Showing "+d((t.currentPage-1)*t.perPage+1)+" to "+d(Math.min(t.currentPage*t.perPage,t.pagination.total))+" of "+d(t.pagination.total),1)):b("",!0)])]),_:1,__:[17]}),l(T,null,{default:s(()=>[l(S,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:e[4]||(e[4]=a=>i.onSort("name"))},[o("div",q,[e[18]||(e[18]=u(" Name ")),l(y,{icon:t.getSortIcon("name"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[5]||(e[5]=a=>i.onSort("slug"))},[o("div",G,[e[19]||(e[19]=u(" Slug ")),l(y,{icon:t.getSortIcon("slug"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[6]||(e[6]=a=>i.onSort("type"))},[o("div",J,[e[20]||(e[20]=u(" Type ")),l(y,{icon:t.getSortIcon("type"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[22]||(e[22]=o("th",null,"Description",-1)),o("th",{class:"sortable",onClick:e[7]||(e[7]=a=>i.onSort("created_at"))},[o("div",K,[e[21]||(e[21]=u(" Created ")),l(y,{icon:t.getSortIcon("created_at"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[23]||(e[23]=o("th",null,"Actions",-1))])]),o("tbody",null,[(g(!0),f(I,null,R(n.tags,a=>(g(),f("tr",{key:a.id},[o("td",null,[o("div",Q,d(a.name),1)]),o("td",null,[l(P,{size:"small",variant:"outlined"},{default:s(()=>[u(d(a.slug),1)]),_:2},1024)]),o("td",null,[l(P,{size:"small",color:"primary",variant:"tonal"},{default:s(()=>[u(d(a.type),1)]),_:2},1024)]),o("td",null,[a.description?(g(),f("span",W,d(a.description),1)):(g(),f("span",X,"No description"))]),o("td",null,[o("span",Y,d(a.created_at?new Date(a.created_at).toLocaleDateString():"-"),1)]),o("td",null,[l(c,{size:"small",icon:"mdi-pencil",onClick:z=>i.editTag(a),variant:"text",color:"primary"},null,8,["onClick"]),l(c,{size:"small",icon:"mdi-delete",onClick:z=>i.deleteTag(a.id),variant:"text",color:"error"},null,8,["onClick"])])]))),128)),n.tags.length===0?(g(),f("tr",Z,e[24]||(e[24]=[o("td",{colspan:"6",class:"text-center py-4"},"No tags found",-1)]))):b("",!0)])]),_:1}),o("div",$,[o("div",ee,[n.tags.length>0?(g(),f("span",te," Showing "+d((t.currentPage-1)*t.perPage+1)+" to "+d(Math.min(t.currentPage*t.perPage,t.pagination.total))+" of "+d(t.pagination.total)+" records ",1)):(g(),f("span",le,"No records found"))]),t.pagination.last_page>1?(g(),B(D,{key:0,modelValue:t.currentPage,"onUpdate:modelValue":[e[8]||(e[8]=a=>t.currentPage=a),i.loadTags],length:t.pagination.last_page},null,8,["modelValue","length","onUpdate:modelValue"])):b("",!0)])]),_:1})]),_:1}),l(N,{modelValue:n.showDialog,"onUpdate:modelValue":e[13]||(e[13]=a=>n.showDialog=a),"max-width":"700",scrollable:"",persistent:""},{default:s(()=>[l(V,null,{default:s(()=>[l(C,{class:"d-flex align-center justify-space-between bg-primary text-white pa-4"},{default:s(()=>[o("span",ae,d(n.editingTag?"Edit Tag":"Create New Tag"),1),l(c,{icon:"mdi-close",variant:"text",color:"white",onClick:i.closeDialog},null,8,["onClick"])]),_:1}),l(T,{class:"pa-6"},{default:s(()=>[l(U,{ref:"formRef"},{default:s(()=>[l(k,null,{default:s(()=>[l(h,{cols:"12"},{default:s(()=>[l(w,{modelValue:n.form.name,"onUpdate:modelValue":e[9]||(e[9]=a=>n.form.name=a),label:"Tag Name *",variant:"outlined",rules:[a=>!!a||"Name is required"],hint:"Enter the tag name"},null,8,["modelValue","rules"])]),_:1}),l(h,{cols:"12",md:"6"},{default:s(()=>[l(w,{modelValue:n.form.slug,"onUpdate:modelValue":e[10]||(e[10]=a=>n.form.slug=a),label:"Slug",variant:"outlined",hint:"URL-friendly version (auto-generated if empty)",rules:[a=>!a||/^[a-z0-9-]+$/.test(a)||"Slug can only contain lowercase letters, numbers, and hyphens"]},{append:s(()=>[l(c,{icon:"mdi-refresh",size:"small",variant:"text",onClick:i.generateSlug},null,8,["onClick"])]),_:1},8,["modelValue","rules"])]),_:1}),l(h,{cols:"12",md:"6"},{default:s(()=>[l(_,{modelValue:n.form.type,"onUpdate:modelValue":e[11]||(e[11]=a=>n.form.type=a),items:n.typeOptions,label:"Type *",variant:"outlined",rules:[a=>!!a||"Type is required"],hint:"Select the type of content this tag applies to"},null,8,["modelValue","items","rules"])]),_:1}),l(h,{cols:"12"},{default:s(()=>[l(F,{modelValue:n.form.description,"onUpdate:modelValue":e[12]||(e[12]=a=>n.form.description=a),label:"Description",variant:"outlined",rows:"3",hint:"Brief description of the tag (optional)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(E,{class:"pa-4 bg-grey-lighten-4"},{default:s(()=>[l(x),l(c,{variant:"text",onClick:i.closeDialog},{default:s(()=>e[25]||(e[25]=[u("Cancel")])),_:1,__:[25]},8,["onClick"]),l(c,{color:"primary",variant:"flat",onClick:i.saveTag,loading:n.saving},{default:s(()=>[u(d(n.editingTag?"Update":"Create")+" Tag ",1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ie=A(M,[["render",oe],["__scopeId","data-v-48fac09e"]]);export{ie as default};
