import{a as R}from"./adminPaginationMixin-DN7Wb3ng.js";import{_ as H,d as g,a as o,b as l,w as s,f as u,r,h as _,t as d,F as k,e as x,o as p}from"./app-CRxyawSL.js";const L={mixins:[R],data(){return{tags:[],showDialog:!1,editingTag:null,saving:!1,typeFilter:null,typeOptions:[{title:"Product",value:"product"},{title:"Service",value:"service"},{title:"Post",value:"post"},{title:"General",value:"general"}],form:{name:"",slug:"",type:"product",description:""}}},async mounted(){await this.loadTags()},methods:{async loadTags(){try{this.loading=!0;const t=this.buildPaginationParams();this.search&&(t.search=this.search),this.typeFilter&&(t.type=this.typeFilter);const e=await this.$axios.get("/api/v1/tags",{params:t,headers:this.getAuthHeaders()});this.tags=e.data.data||[],this.updatePagination(e.data)}catch(t){this.handleApiError(t,"Failed to load tags")}finally{this.loading=!1}},async openDialog(t=null){if(this.editingTag=t,this.showDialog=!0,t)try{await this.loadTagForEdit(t)}catch(e){console.error("Error loading tag for edit:",e)}else this.resetForm()},async loadTagForEdit(t){var e;try{const m=await this.$axios.get(`/api/v1/tags/${t.id}`,{headers:this.getAuthHeaders()}),c=((e=m.data)==null?void 0:e.data)||m.data;if(!c)throw new Error("No tag data received from server");this.form={name:c.name||"",slug:c.slug||"",type:c.type||"product",description:c.description||""}}catch(m){throw this.handleApiError(m,"Failed to load tag"),m}},resetForm(){this.form={name:"",slug:"",type:this.typeFilter||"product",description:""}},generateSlug(){this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""))},async saveTag(){const{valid:t}=await this.$refs.formRef.validate();if(!t){this.showError("Please fill in all required fields");return}try{this.saving=!0;const e={name:this.form.name,type:this.form.type,description:this.form.description||null};this.form.slug&&(e.slug=this.form.slug),this.editingTag?(await this.$axios.put(`/api/v1/tags/${this.editingTag.id}`,e,{headers:this.getAuthHeaders()}),this.showSuccess("Tag updated successfully")):(await this.$axios.post("/api/v1/tags",e,{headers:this.getAuthHeaders()}),this.showSuccess("Tag created successfully")),this.closeDialog(),await this.loadTags()}catch(e){this.handleApiError(e,"Failed to save tag")}finally{this.saving=!1}},editTag(t){this.openDialog(t)},async deleteTag(t){var e,m,c,n;if(confirm("Are you sure you want to delete this tag? This action cannot be undone."))try{await this.$axios.delete(`/api/v1/tags/${t}`,{headers:this.getAuthHeaders()}),this.showSuccess("Tag deleted successfully"),await this.loadTags()}catch(i){const f=((m=(e=i.response)==null?void 0:e.data)==null?void 0:m.error)||((n=(c=i.response)==null?void 0:c.data)==null?void 0:n.message)||"Error deleting tag";this.showError(f)}},closeDialog(){this.showDialog=!1,this.editingTag=null,this.resetForm(),this.$refs.formRef&&this.$refs.formRef.resetValidation()},onPerPageChange(){this.resetPagination(),this.loadTags()},onSort(t){this.handleSort(t),this.loadTags()}}},M={class:"page-header"},B={class:"text-caption text-grey"},O={key:0},j={class:"d-flex align-center"},q={class:"d-flex align-center"},G={class:"d-flex align-center"},J={class:"d-flex align-center"},K={class:"d-flex"},Q={class:"font-weight-medium"},W={key:0,class:"text-body-2"},X={key:1,class:"text-caption text-grey"},Y={class:"text-caption"},Z={key:0},$={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},ee={class:"text-caption text-grey"},te={key:0},le={key:0,class:"ml-2"},ae={key:1},oe={key:0,class:"d-flex align-center gap-2"},se={class:"text-h5 font-weight-bold"};function ne(t,e,m,c,n,i){const f=r("v-btn"),w=r("v-select"),h=r("v-col"),T=r("v-text-field"),C=r("v-row"),b=r("v-card-text"),V=r("v-card"),P=r("v-card-title"),y=r("v-icon"),v=r("v-skeleton-loader"),S=r("v-chip"),D=r("v-table"),F=r("v-pagination"),U=r("v-textarea"),E=r("v-form"),N=r("v-spacer"),z=r("v-card-actions"),A=r("v-dialog");return p(),g("div",null,[o("div",M,[e[15]||(e[15]=o("h1",{class:"text-h4 page-title"},"Tags Management",-1)),l(f,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=a=>i.openDialog()),class:"add-button"},{default:s(()=>e[14]||(e[14]=[u("Create Tag")])),_:1,__:[14]})]),l(V,{class:"mb-4"},{default:s(()=>[l(b,null,{default:s(()=>[l(C,null,{default:s(()=>[l(h,{cols:"12",md:"3"},{default:s(()=>[l(w,{modelValue:t.perPage,"onUpdate:modelValue":[e[1]||(e[1]=a=>t.perPage=a),i.onPerPageChange],items:t.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(h,{cols:"12",md:"3"},{default:s(()=>[l(w,{modelValue:n.typeFilter,"onUpdate:modelValue":[e[2]||(e[2]=a=>n.typeFilter=a),i.loadTags],items:n.typeOptions,label:"Filter by Type","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),l(h,{cols:"12",md:"6"},{default:s(()=>[l(T,{modelValue:t.search,"onUpdate:modelValue":[e[3]||(e[3]=a=>t.search=a),i.loadTags],label:"Search tags","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(V,null,{default:s(()=>[l(P,{class:"d-flex justify-space-between align-center"},{default:s(()=>[e[17]||(e[17]=o("span",null,"Tags",-1)),o("span",B,[e[16]||(e[16]=u(" Total Records: ")),o("strong",null,d(t.pagination.total||0),1),n.tags.length>0?(p(),g("span",O," | Showing "+d((t.currentPage-1)*t.perPage+1)+" to "+d(Math.min(t.currentPage*t.perPage,t.pagination.total))+" of "+d(t.pagination.total),1)):_("",!0)])]),_:1,__:[17]}),l(b,null,{default:s(()=>[l(D,null,{default:s(()=>[o("thead",null,[o("tr",null,[o("th",{class:"sortable",onClick:e[4]||(e[4]=a=>i.onSort("name"))},[o("div",j,[e[18]||(e[18]=u(" Name ")),l(y,{icon:t.getSortIcon("name"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[5]||(e[5]=a=>i.onSort("slug"))},[o("div",q,[e[19]||(e[19]=u(" Slug ")),l(y,{icon:t.getSortIcon("slug"),size:"small",class:"ml-1"},null,8,["icon"])])]),o("th",{class:"sortable",onClick:e[6]||(e[6]=a=>i.onSort("type"))},[o("div",G,[e[20]||(e[20]=u(" Type ")),l(y,{icon:t.getSortIcon("type"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[22]||(e[22]=o("th",null,"Description",-1)),o("th",{class:"sortable",onClick:e[7]||(e[7]=a=>i.onSort("created_at"))},[o("div",J,[e[21]||(e[21]=u(" Created ")),l(y,{icon:t.getSortIcon("created_at"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[23]||(e[23]=o("th",null,"Actions",-1))])]),o("tbody",null,[t.loading?(p(),g(k,{key:0},x(5,a=>o("tr",{key:`skeleton-${a}`},[o("td",null,[l(v,{type:"text",width:"150"})]),o("td",null,[l(v,{type:"chip",width:"120",height:"24"})]),o("td",null,[l(v,{type:"chip",width:"80",height:"24"})]),o("td",null,[l(v,{type:"text",width:"200"})]),o("td",null,[l(v,{type:"text",width:"100"})]),o("td",null,[o("div",K,[l(v,{type:"button",width:"32",height:"32",class:"mr-1"}),l(v,{type:"button",width:"32",height:"32"})])])])),64)):(p(),g(k,{key:1},[(p(!0),g(k,null,x(n.tags,a=>(p(),g("tr",{key:a.id},[o("td",null,[o("div",Q,d(a.name),1)]),o("td",null,[l(S,{size:"small",variant:"outlined"},{default:s(()=>[u(d(a.slug),1)]),_:2},1024)]),o("td",null,[l(S,{size:"small",color:"primary",variant:"tonal"},{default:s(()=>[u(d(a.type),1)]),_:2},1024)]),o("td",null,[a.description?(p(),g("span",W,d(a.description),1)):(p(),g("span",X,"No description"))]),o("td",null,[o("span",Y,d(a.created_at?new Date(a.created_at).toLocaleDateString():"-"),1)]),o("td",null,[l(f,{size:"small",icon:"mdi-pencil",onClick:I=>i.editTag(a),variant:"text",color:"primary"},null,8,["onClick"]),l(f,{size:"small",icon:"mdi-delete",onClick:I=>i.deleteTag(a.id),variant:"text",color:"error"},null,8,["onClick"])])]))),128)),n.tags.length===0?(p(),g("tr",Z,e[24]||(e[24]=[o("td",{colspan:"6",class:"text-center py-4"},"No tags found",-1)]))):_("",!0)],64))])]),_:1}),o("div",$,[o("div",ee,[n.tags.length>0&&t.pagination.total>0?(p(),g("span",te,[e[25]||(e[25]=u(" Showing ")),o("strong",null,d((t.currentPage-1)*t.perPage+1),1),e[26]||(e[26]=u(" to ")),o("strong",null,d(Math.min(t.currentPage*t.perPage,t.pagination.total)),1),e[27]||(e[27]=u(" of ")),o("strong",null,d(t.pagination.total.toLocaleString()),1),e[28]||(e[28]=u(" records ")),t.pagination.last_page>1?(p(),g("span",le," (Page "+d(t.currentPage)+" of "+d(t.pagination.last_page)+") ",1)):_("",!0)])):(p(),g("span",ae,"No records found"))]),t.pagination.last_page>1?(p(),g("div",oe,[l(F,{modelValue:t.currentPage,"onUpdate:modelValue":[e[8]||(e[8]=a=>t.currentPage=a),i.loadTags],length:t.pagination.last_page,"total-visible":7,density:"comfortable"},null,8,["modelValue","length","onUpdate:modelValue"])])):_("",!0)])]),_:1})]),_:1}),l(A,{modelValue:n.showDialog,"onUpdate:modelValue":e[13]||(e[13]=a=>n.showDialog=a),"max-width":"700",scrollable:"",persistent:""},{default:s(()=>[l(V,null,{default:s(()=>[l(P,{class:"d-flex align-center justify-space-between bg-primary text-white pa-4"},{default:s(()=>[o("span",se,d(n.editingTag?"Edit Tag":"Create New Tag"),1),l(f,{icon:"mdi-close",variant:"text",color:"white",onClick:i.closeDialog},null,8,["onClick"])]),_:1}),l(b,{class:"pa-6"},{default:s(()=>[l(E,{ref:"formRef"},{default:s(()=>[l(C,null,{default:s(()=>[l(h,{cols:"12"},{default:s(()=>[l(T,{modelValue:n.form.name,"onUpdate:modelValue":e[9]||(e[9]=a=>n.form.name=a),label:"Tag Name *",variant:"outlined",rules:[a=>!!a||"Name is required"],hint:"Enter the tag name"},null,8,["modelValue","rules"])]),_:1}),l(h,{cols:"12",md:"6"},{default:s(()=>[l(T,{modelValue:n.form.slug,"onUpdate:modelValue":e[10]||(e[10]=a=>n.form.slug=a),label:"Slug",variant:"outlined",hint:"URL-friendly version (auto-generated if empty)",rules:[a=>!a||/^[a-z0-9-]+$/.test(a)||"Slug can only contain lowercase letters, numbers, and hyphens"]},{append:s(()=>[l(f,{icon:"mdi-refresh",size:"small",variant:"text",onClick:i.generateSlug},null,8,["onClick"])]),_:1},8,["modelValue","rules"])]),_:1}),l(h,{cols:"12",md:"6"},{default:s(()=>[l(w,{modelValue:n.form.type,"onUpdate:modelValue":e[11]||(e[11]=a=>n.form.type=a),items:n.typeOptions,label:"Type *",variant:"outlined",rules:[a=>!!a||"Type is required"],hint:"Select the type of content this tag applies to"},null,8,["modelValue","items","rules"])]),_:1}),l(h,{cols:"12"},{default:s(()=>[l(U,{modelValue:n.form.description,"onUpdate:modelValue":e[12]||(e[12]=a=>n.form.description=a),label:"Description",variant:"outlined",rows:"3",hint:"Brief description of the tag (optional)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(z,{class:"pa-4 bg-grey-lighten-4"},{default:s(()=>[l(N),l(f,{variant:"text",onClick:i.closeDialog},{default:s(()=>e[29]||(e[29]=[u("Cancel")])),_:1,__:[29]},8,["onClick"]),l(f,{color:"primary",variant:"flat",onClick:i.saveTag,loading:n.saving},{default:s(()=>[u(d(n.editingTag?"Update":"Create")+" Tag ",1)]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const de=H(L,[["render",ne],["__scopeId","data-v-4ae0f862"]]);export{de as default};
