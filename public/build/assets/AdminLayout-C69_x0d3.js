import{_ as L,c as d,a as n,w as o,r as t,b as g,o as r,f as a,h as l,m as N,d as h,g as v,t as f,F as z,e as E}from"./app-lD5pKros.js";const D={data(){return{drawer:!0,currentUser:null,userRoles:[],userPermissions:[]}},methods:{async loadUser(){var u;try{const e=localStorage.getItem("admin_token");if(!e){this.$router.push("/admin/login");return}const p=await g.get("/api/v1/auth/user",{headers:{Authorization:`Bearer ${e}`}});this.currentUser=p.data,this.userRoles=p.data.roles||[],this.userPermissions=[],this.userRoles&&this.userRoles.length>0&&this.userRoles.forEach(_=>{_.permissions&&_.permissions.length>0&&_.permissions.forEach(s=>{this.userPermissions.includes(s.slug)||this.userPermissions.push(s.slug)})})}catch(e){console.error("Error loading user:",e),((u=e.response)==null?void 0:u.status)===401&&(localStorage.removeItem("admin_token"),this.$router.push("/admin/login"))}},async logout(){try{await g.post("/api/v1/auth/logout",{},{headers:{Authorization:`Bearer ${localStorage.getItem("admin_token")}`}}),localStorage.removeItem("admin_token"),this.currentUser=null,this.userRoles=[],this.userPermissions=[],this.$router.push("/admin/login")}catch(u){console.error("Logout error:",u),localStorage.removeItem("admin_token"),this.currentUser=null,this.userRoles=[],this.userPermissions=[],this.$router.push("/admin/login")}},hasPermission(u){return this.currentUser&&(this.currentUser.role==="admin"||this.userRoles&&this.userRoles.some(e=>e.slug==="administrator"))?!0:this.userPermissions.includes(u)}},mounted(){localStorage.getItem("admin_token")?this.loadUser():this.$router.push("/admin/login")}},F={key:0,class:"d-flex align-center mr-4"},T={class:"d-flex flex-column mr-4"},j={class:"text-body-2 font-weight-medium"},q={key:0,class:"d-flex align-center mt-1"},G={key:1,class:"text-caption text-grey"};function H(u,e,p,_,s,m){const i=t("v-list-item"),k=t("v-list-group"),P=t("v-list"),y=t("v-navigation-drawer"),w=t("v-app-bar-nav-icon"),U=t("v-toolbar-title"),R=t("v-spacer"),b=t("v-img"),x=t("v-avatar"),A=t("v-chip"),S=t("v-btn"),V=t("v-app-bar"),B=t("router-view"),C=t("v-container"),I=t("v-main");return r(),d("div",null,[n(y,{modelValue:s.drawer,"onUpdate:modelValue":e[0]||(e[0]=c=>s.drawer=c),app:""},{default:o(()=>[n(P,null,{default:o(()=>[m.hasPermission("access-dashboard")?(r(),a(i,{key:0,"prepend-icon":"mdi-view-dashboard",title:"Dashboard",to:{name:"AdminDashboard"}})):l("",!0),m.hasPermission("manage-pages")?(r(),a(i,{key:1,"prepend-icon":"mdi-file-document",title:"Pages",to:{name:"AdminPages"}})):l("",!0),m.hasPermission("manage-services")?(r(),a(i,{key:2,"prepend-icon":"mdi-wrench",title:"Services",to:{name:"AdminServices"}})):l("",!0),m.hasPermission("manage-products")?(r(),a(i,{key:3,"prepend-icon":"mdi-package-variant",title:"Products",to:{name:"AdminProducts"}})):l("",!0),m.hasPermission("view-leads")?(r(),a(i,{key:4,"prepend-icon":"mdi-email",title:"Leads",to:{name:"AdminLeads"}})):l("",!0),m.hasPermission("manage-users")?(r(),a(i,{key:5,"prepend-icon":"mdi-account-group",title:"Users",to:{name:"AdminUsers"}})):l("",!0),m.hasPermission("manage-roles")?(r(),a(k,{key:6},{activator:o(({props:c})=>[n(i,N(c,{"prepend-icon":"mdi-shield-account",title:"Roles & Permissions"}),null,16)]),default:o(()=>[n(i,{"prepend-icon":"mdi-shield-account",title:"Roles",to:{name:"AdminRoles"}}),n(i,{"prepend-icon":"mdi-key",title:"Permissions",to:{name:"AdminPermissions"}})]),_:1})):l("",!0),m.hasPermission("manage-settings")?(r(),a(i,{key:7,"prepend-icon":"mdi-cog",title:"Settings",to:{name:"AdminSettings"}})):l("",!0)]),_:1})]),_:1},8,["modelValue"]),n(V,{app:""},{default:o(()=>[n(w,{onClick:e[1]||(e[1]=c=>s.drawer=!s.drawer)}),n(U,null,{default:o(()=>e[2]||(e[2]=[h("Admin Panel")])),_:1,__:[2]}),n(R),s.currentUser?(r(),d("div",F,[s.currentUser.avatar?(r(),a(x,{key:0,size:"32",class:"mr-3"},{default:o(()=>[n(b,{src:s.currentUser.avatar,alt:s.currentUser.name},null,8,["src","alt"])]),_:1})):l("",!0),v("div",T,[v("div",j,f(s.currentUser.name),1),s.userRoles&&s.userRoles.length>0?(r(),d("div",q,[(r(!0),d(z,null,E(s.userRoles,c=>(r(),a(A,{key:c.id,size:"small",color:c.is_system?"warning":"primary",variant:"flat",class:"mr-1"},{default:o(()=>[h(f(c.name),1)]),_:2},1032,["color"]))),128))])):(r(),d("span",G,"No roles assigned"))])])):l("",!0),n(S,{onClick:m.logout,"prepend-icon":"mdi-logout"},{default:o(()=>e[3]||(e[3]=[h("Logout")])),_:1,__:[3]},8,["onClick"])]),_:1}),n(I,null,{default:o(()=>[n(C,{fluid:""},{default:o(()=>[n(B)]),_:1})]),_:1})])}const K=L(D,[["render",H]]);export{K as default};
